(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{439:function(t,a,n){"use strict";n.r(a);var s=n(10),e=Object(s.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("blockquote",[n("p",[t._v("专栏原创出处："),n("a",{attrs:{href:"https://github.com/GourdErwa/review-notes/tree/master/framework/flink-basis",target:"_blank",rel:"noopener noreferrer"}},[t._v("github-源笔记文件 "),n("OutboundLink")],1),t._v(" ，"),n("a",{attrs:{href:"https://github.com/GourdErwa/flink-advanced",target:"_blank",rel:"noopener noreferrer"}},[t._v("github-源码 "),n("OutboundLink")],1),t._v("，欢迎 Star，转载请附上原文出处链接和本声明。")])]),t._v(" "),n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#zipwithindex-方式分配"}},[t._v("zipWithIndex 方式分配")])]),n("li",[n("a",{attrs:{href:"#zipwithuniqueid-方式分配"}},[t._v("zipWithUniqueId 方式分配")])])])]),n("p"),t._v(" "),n("h1",{attrs:{id:"dataset分配唯一标识符"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dataset分配唯一标识符"}},[t._v("#")]),t._v(" DataSet分配唯一标识符")]),t._v(" "),n("p",[t._v("在某些算法中，可能需要为数据集元素分配唯一标识符。[[org.apache.flink.api.scala.utils.DataSetUtils]] scala 包装类"),n("br"),t._v("\n具体实现源码可参考 "),n("a",{attrs:{href:"https://github.com/apache/flink/blob/master//flink-java/src/main/java/org/apache/flink/api/java/utils/DataSetUtils.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("DataSetUtils"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"zipwithindex-方式分配"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zipwithindex-方式分配"}},[t._v("#")]),t._v(" "),n("strong",[t._v("zipWithIndex")]),t._v(" 方式分配")]),t._v(" "),n("p",[t._v("为元素分配连续的标签，接收数据集作为输入并返回 DataSet[(Long, T)] 2 元组的新数据集。"),n("br"),t._v("\n此过程需要两步操作，首先是计数，然后是标记元素，由于计数同步，因此无法进行流水线处理。"),n("br"),t._v("\n替代方法 zipWithUniqueId 以流水线方式工作，当唯一的标签足够时，它是首选方法。")]),t._v(" "),n("h2",{attrs:{id:"zipwithuniqueid-方式分配"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zipwithuniqueid-方式分配"}},[t._v("#")]),t._v(" "),n("strong",[t._v("zipWithUniqueId")]),t._v(" 方式分配")]),t._v(" "),n("p",[t._v("在许多情况下，可能不需要分配连续的标签。"),n("br"),t._v("\nzipWithUniqueId 以管道方式工作，加快了标签分配过程。"),n("br"),t._v("\n此方法接收一个数据集作为输入，并返回一个新的 DataSet[(Long, T)] 2 元组数据集")]),t._v(" "),n("p",[t._v("代码示例 "),n("a",{attrs:{href:"https://github.com/GourdErwa/flink-advanced/blob/master/src/main/scala/io/gourd/flink/scala/games/batch/ZippingElements.scala",target:"_blank",rel:"noopener noreferrer"}},[t._v("ZippingElements"),n("OutboundLink")],1),t._v(" ：")]),t._v(" "),n("div",{staticClass:"language-scala extra-class"},[n("pre",{pre:!0,attrs:{class:"language-scala"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("io"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gourd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flink"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scala"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),t._v("BatchExecutionEnvironmentApp\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/** 在某些算法中，可能需要为数据集元素分配唯一标识符。\n  * 本文档说明了如何将\n  * [[org.apache.flink.api.scala.utils.DataSetUtils]]\n  * [[org.apache.flink.api.java.utils.DataSetUtils.zipWithIndex()]]\n  * [[org.apache.flink.api.java.utils.DataSetUtils.zipWithUniqueId()]]\n  * 用于此目的。\n  *\n  * @author Li.Wei by 2019/11/12\n  */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("object")]),t._v(" ZippingElements "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" BatchExecutionEnvironmentApp "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flink"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scala"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),t._v("_\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" input"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" DataSet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" bEnv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fromElements"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"B"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"E"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"F"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"G"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"H"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  bEnv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("setParallelism"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n  zipWithIndex 为元素分配连续的标签，接收数据集作为输入并返回 DataSet[(Long, T)] 2 元组的新数据集。\n  此过程需要两步操作，首先是计数，然后是标记元素，由于计数同步，因此无法进行流水线处理。\n  替代方法 zipWithUniqueId 以流水线方式工作，当唯一的标签足够时，它是首选方法。\n   */")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flink"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scala"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("utils"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),t._v("DataSetUtils\n\n  input"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zipWithIndex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("print"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n(0,A)\n(1,B)\n(2,C)\n(3,D)\n(4,E)\n(5,F)\n(6,G)\n(7,H)\n */")]),t._v("\n  println"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n  在许多情况下，可能不需要分配连续的标签。\n  zipWithUniqueId 以管道方式工作，加快了标签分配过程。\n  此方法接收一个数据集作为输入，并返回一个新的 DataSet[(Long, T)] 2 元组数据集\n  \n  本机执行，未发生并行，实际情况参考分布式测试结果\n   */")]),t._v("\n  input"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zipWithUniqueId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("print"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n(0,A)\n(1,B)\n(2,C)\n(3,D)\n(4,E)\n(5,F)\n(6,G)\n(7,H)\n   */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);