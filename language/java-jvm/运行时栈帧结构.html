<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>复盘笔记</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="review notes">
    
    <link rel="preload" href="/assets/css/0.styles.dd0c7c90.css" as="style"><link rel="preload" href="/assets/js/app.37e3de20.js" as="script"><link rel="preload" href="/assets/js/2.62143406.js" as="script"><link rel="preload" href="/assets/js/190.a92b0d15.js" as="script"><link rel="prefetch" href="/assets/js/10.9609e070.js"><link rel="prefetch" href="/assets/js/100.2567414c.js"><link rel="prefetch" href="/assets/js/101.fc45ea0c.js"><link rel="prefetch" href="/assets/js/102.d9db093d.js"><link rel="prefetch" href="/assets/js/103.bba45522.js"><link rel="prefetch" href="/assets/js/104.591d2d15.js"><link rel="prefetch" href="/assets/js/105.c50697e9.js"><link rel="prefetch" href="/assets/js/106.4cc1e019.js"><link rel="prefetch" href="/assets/js/107.e3bca9e7.js"><link rel="prefetch" href="/assets/js/108.298a950d.js"><link rel="prefetch" href="/assets/js/109.18904529.js"><link rel="prefetch" href="/assets/js/11.900febed.js"><link rel="prefetch" href="/assets/js/110.96e53377.js"><link rel="prefetch" href="/assets/js/111.2297b1e2.js"><link rel="prefetch" href="/assets/js/112.c64f1088.js"><link rel="prefetch" href="/assets/js/113.176fb65c.js"><link rel="prefetch" href="/assets/js/114.d5398027.js"><link rel="prefetch" href="/assets/js/115.e1c662de.js"><link rel="prefetch" href="/assets/js/116.5fdbfed9.js"><link rel="prefetch" href="/assets/js/117.47675570.js"><link rel="prefetch" href="/assets/js/118.3298b037.js"><link rel="prefetch" href="/assets/js/119.2e909964.js"><link rel="prefetch" href="/assets/js/12.37757940.js"><link rel="prefetch" href="/assets/js/120.64406ce8.js"><link rel="prefetch" href="/assets/js/121.c95e563f.js"><link rel="prefetch" href="/assets/js/122.4453a121.js"><link rel="prefetch" href="/assets/js/123.260f89b3.js"><link rel="prefetch" href="/assets/js/124.10ef3c26.js"><link rel="prefetch" href="/assets/js/125.3c602a18.js"><link rel="prefetch" href="/assets/js/126.e7267ed3.js"><link rel="prefetch" href="/assets/js/127.0d0d61f1.js"><link rel="prefetch" href="/assets/js/128.1e28501a.js"><link rel="prefetch" href="/assets/js/129.a2d73feb.js"><link rel="prefetch" href="/assets/js/13.efcae11b.js"><link rel="prefetch" href="/assets/js/130.b0b2f780.js"><link rel="prefetch" href="/assets/js/131.fae4d0d7.js"><link rel="prefetch" href="/assets/js/132.f46ca888.js"><link rel="prefetch" href="/assets/js/133.ea331d23.js"><link rel="prefetch" href="/assets/js/134.92f03a3f.js"><link rel="prefetch" href="/assets/js/135.d42016da.js"><link rel="prefetch" href="/assets/js/136.d2f611e2.js"><link rel="prefetch" href="/assets/js/137.6cd857fc.js"><link rel="prefetch" href="/assets/js/138.2a1892fe.js"><link rel="prefetch" href="/assets/js/139.7fbbeaf7.js"><link rel="prefetch" href="/assets/js/14.ceabcb57.js"><link rel="prefetch" href="/assets/js/140.5036b048.js"><link rel="prefetch" href="/assets/js/141.171e245f.js"><link rel="prefetch" href="/assets/js/142.41c17780.js"><link rel="prefetch" href="/assets/js/143.ad5a39aa.js"><link rel="prefetch" href="/assets/js/144.10f5d900.js"><link rel="prefetch" href="/assets/js/145.f389825e.js"><link rel="prefetch" href="/assets/js/146.9caf1135.js"><link rel="prefetch" href="/assets/js/147.cbaa6cc7.js"><link rel="prefetch" href="/assets/js/148.2d16cf13.js"><link rel="prefetch" href="/assets/js/149.c73e2c9b.js"><link rel="prefetch" href="/assets/js/15.6aaa7528.js"><link rel="prefetch" href="/assets/js/150.a765cd68.js"><link rel="prefetch" href="/assets/js/151.86932a05.js"><link rel="prefetch" href="/assets/js/152.795aaa19.js"><link rel="prefetch" href="/assets/js/153.4490970b.js"><link rel="prefetch" href="/assets/js/154.da72b866.js"><link rel="prefetch" href="/assets/js/155.97ec441d.js"><link rel="prefetch" href="/assets/js/156.6abb8c2d.js"><link rel="prefetch" href="/assets/js/157.18a60685.js"><link rel="prefetch" href="/assets/js/158.a72809f8.js"><link rel="prefetch" href="/assets/js/159.e60c32f2.js"><link rel="prefetch" href="/assets/js/16.7550d427.js"><link rel="prefetch" href="/assets/js/160.6ea86d6e.js"><link rel="prefetch" href="/assets/js/161.16316add.js"><link rel="prefetch" href="/assets/js/162.bdb4bbfb.js"><link rel="prefetch" href="/assets/js/163.3dc5091b.js"><link rel="prefetch" href="/assets/js/164.cb8daa6d.js"><link rel="prefetch" href="/assets/js/165.15f08699.js"><link rel="prefetch" href="/assets/js/166.ea983d4d.js"><link rel="prefetch" href="/assets/js/167.f036bba7.js"><link rel="prefetch" href="/assets/js/168.97646254.js"><link rel="prefetch" href="/assets/js/169.a288924b.js"><link rel="prefetch" href="/assets/js/17.08e97cb4.js"><link rel="prefetch" href="/assets/js/170.731a216f.js"><link rel="prefetch" href="/assets/js/171.866714c0.js"><link rel="prefetch" href="/assets/js/172.5e7a2a0d.js"><link rel="prefetch" href="/assets/js/173.238147e5.js"><link rel="prefetch" href="/assets/js/174.350467b9.js"><link rel="prefetch" href="/assets/js/175.8d6d1640.js"><link rel="prefetch" href="/assets/js/176.d846cf90.js"><link rel="prefetch" href="/assets/js/177.31d05821.js"><link rel="prefetch" href="/assets/js/178.6593f7ca.js"><link rel="prefetch" href="/assets/js/179.06fe5cbf.js"><link rel="prefetch" href="/assets/js/18.544b6311.js"><link rel="prefetch" href="/assets/js/180.7300d2c6.js"><link rel="prefetch" href="/assets/js/181.c4bb6240.js"><link rel="prefetch" href="/assets/js/182.15e5b839.js"><link rel="prefetch" href="/assets/js/183.3e0287c0.js"><link rel="prefetch" href="/assets/js/184.ec09142a.js"><link rel="prefetch" href="/assets/js/185.e53e64f1.js"><link rel="prefetch" href="/assets/js/186.32f610a0.js"><link rel="prefetch" href="/assets/js/187.b9bd2b98.js"><link rel="prefetch" href="/assets/js/188.9f76f2ad.js"><link rel="prefetch" href="/assets/js/189.347ba95d.js"><link rel="prefetch" href="/assets/js/19.81b9cf0f.js"><link rel="prefetch" href="/assets/js/191.74831fca.js"><link rel="prefetch" href="/assets/js/192.ce14cca0.js"><link rel="prefetch" href="/assets/js/193.20a0998a.js"><link rel="prefetch" href="/assets/js/194.c3ee4e44.js"><link rel="prefetch" href="/assets/js/195.8b8c285f.js"><link rel="prefetch" href="/assets/js/196.85afa32b.js"><link rel="prefetch" href="/assets/js/197.c1920eee.js"><link rel="prefetch" href="/assets/js/198.a438d8cb.js"><link rel="prefetch" href="/assets/js/199.855b907f.js"><link rel="prefetch" href="/assets/js/20.0c543175.js"><link rel="prefetch" href="/assets/js/200.a8c4967e.js"><link rel="prefetch" href="/assets/js/201.d9bcc342.js"><link rel="prefetch" href="/assets/js/202.e154fe1c.js"><link rel="prefetch" href="/assets/js/203.cd8fd153.js"><link rel="prefetch" href="/assets/js/204.4294d100.js"><link rel="prefetch" href="/assets/js/205.d1f2bfcc.js"><link rel="prefetch" href="/assets/js/206.ffb4ace8.js"><link rel="prefetch" href="/assets/js/207.5aba597b.js"><link rel="prefetch" href="/assets/js/208.0d90d668.js"><link rel="prefetch" href="/assets/js/209.15d91907.js"><link rel="prefetch" href="/assets/js/21.af75c0dd.js"><link rel="prefetch" href="/assets/js/210.15369821.js"><link rel="prefetch" href="/assets/js/211.50aa81b7.js"><link rel="prefetch" href="/assets/js/212.72b01dda.js"><link rel="prefetch" href="/assets/js/213.a1ed0844.js"><link rel="prefetch" href="/assets/js/214.e4ee1900.js"><link rel="prefetch" href="/assets/js/215.eb219274.js"><link rel="prefetch" href="/assets/js/216.29b45d0e.js"><link rel="prefetch" href="/assets/js/217.525d8d20.js"><link rel="prefetch" href="/assets/js/218.9ff7d8bf.js"><link rel="prefetch" href="/assets/js/219.e3a092c2.js"><link rel="prefetch" href="/assets/js/22.f939c16a.js"><link rel="prefetch" href="/assets/js/220.75ed18ca.js"><link rel="prefetch" href="/assets/js/221.555e7ed5.js"><link rel="prefetch" href="/assets/js/23.cfaeb6af.js"><link rel="prefetch" href="/assets/js/24.a1ee3f0b.js"><link rel="prefetch" href="/assets/js/25.62185f2d.js"><link rel="prefetch" href="/assets/js/26.aee3bb9d.js"><link rel="prefetch" href="/assets/js/27.230a59a7.js"><link rel="prefetch" href="/assets/js/28.f3e42bbe.js"><link rel="prefetch" href="/assets/js/29.d01e252d.js"><link rel="prefetch" href="/assets/js/3.ab08e223.js"><link rel="prefetch" href="/assets/js/30.439efd91.js"><link rel="prefetch" href="/assets/js/31.d8073f55.js"><link rel="prefetch" href="/assets/js/32.25c41882.js"><link rel="prefetch" href="/assets/js/33.259198d3.js"><link rel="prefetch" href="/assets/js/34.5374bd11.js"><link rel="prefetch" href="/assets/js/35.57fcde42.js"><link rel="prefetch" href="/assets/js/36.38b1aadf.js"><link rel="prefetch" href="/assets/js/37.eaf42ca5.js"><link rel="prefetch" href="/assets/js/38.a3840f3a.js"><link rel="prefetch" href="/assets/js/39.de97a737.js"><link rel="prefetch" href="/assets/js/4.57090dad.js"><link rel="prefetch" href="/assets/js/40.fb41baf0.js"><link rel="prefetch" href="/assets/js/41.8f711a44.js"><link rel="prefetch" href="/assets/js/42.6c5cc459.js"><link rel="prefetch" href="/assets/js/43.d2eeab36.js"><link rel="prefetch" href="/assets/js/44.b1723baf.js"><link rel="prefetch" href="/assets/js/45.af30ecda.js"><link rel="prefetch" href="/assets/js/46.742f09c9.js"><link rel="prefetch" href="/assets/js/47.f4464f1e.js"><link rel="prefetch" href="/assets/js/48.2d17d930.js"><link rel="prefetch" href="/assets/js/49.7a3e0db0.js"><link rel="prefetch" href="/assets/js/5.e471fe2c.js"><link rel="prefetch" href="/assets/js/50.ca133bf7.js"><link rel="prefetch" href="/assets/js/51.2c9de24d.js"><link rel="prefetch" href="/assets/js/52.c331a4c8.js"><link rel="prefetch" href="/assets/js/53.8653237a.js"><link rel="prefetch" href="/assets/js/54.03b9c74c.js"><link rel="prefetch" href="/assets/js/55.cb0cefb3.js"><link rel="prefetch" href="/assets/js/56.86de1a0a.js"><link rel="prefetch" href="/assets/js/57.7bd9a7f3.js"><link rel="prefetch" href="/assets/js/58.6970bffa.js"><link rel="prefetch" href="/assets/js/59.262ab555.js"><link rel="prefetch" href="/assets/js/6.f647628a.js"><link rel="prefetch" href="/assets/js/60.60e10afa.js"><link rel="prefetch" href="/assets/js/61.edb55b77.js"><link rel="prefetch" href="/assets/js/62.6c0db859.js"><link rel="prefetch" href="/assets/js/63.d482be60.js"><link rel="prefetch" href="/assets/js/64.c2b4b739.js"><link rel="prefetch" href="/assets/js/65.f69fdc6d.js"><link rel="prefetch" href="/assets/js/66.126c8209.js"><link rel="prefetch" href="/assets/js/67.f8b7b5c2.js"><link rel="prefetch" href="/assets/js/68.7f3067a6.js"><link rel="prefetch" href="/assets/js/69.5797703d.js"><link rel="prefetch" href="/assets/js/7.305109e0.js"><link rel="prefetch" href="/assets/js/70.1003bd54.js"><link rel="prefetch" href="/assets/js/71.12ff7259.js"><link rel="prefetch" href="/assets/js/72.d464351d.js"><link rel="prefetch" href="/assets/js/73.bcd6099a.js"><link rel="prefetch" href="/assets/js/74.168bb169.js"><link rel="prefetch" href="/assets/js/75.9008ee26.js"><link rel="prefetch" href="/assets/js/76.8a3cd720.js"><link rel="prefetch" href="/assets/js/77.ead54741.js"><link rel="prefetch" href="/assets/js/78.d0a90b8b.js"><link rel="prefetch" href="/assets/js/79.8915da2f.js"><link rel="prefetch" href="/assets/js/8.de463583.js"><link rel="prefetch" href="/assets/js/80.083a14e1.js"><link rel="prefetch" href="/assets/js/81.1e971b59.js"><link rel="prefetch" href="/assets/js/82.d804e19a.js"><link rel="prefetch" href="/assets/js/83.18f143bc.js"><link rel="prefetch" href="/assets/js/84.4bd1dd4c.js"><link rel="prefetch" href="/assets/js/85.51c68f3a.js"><link rel="prefetch" href="/assets/js/86.4d9b103e.js"><link rel="prefetch" href="/assets/js/87.ebaecd3a.js"><link rel="prefetch" href="/assets/js/88.86e82ef4.js"><link rel="prefetch" href="/assets/js/89.feb2cb0e.js"><link rel="prefetch" href="/assets/js/9.6de1a90f.js"><link rel="prefetch" href="/assets/js/90.9a6073d9.js"><link rel="prefetch" href="/assets/js/91.1542bd28.js"><link rel="prefetch" href="/assets/js/92.bb6d84b2.js"><link rel="prefetch" href="/assets/js/93.d4ed17c4.js"><link rel="prefetch" href="/assets/js/94.4f990303.js"><link rel="prefetch" href="/assets/js/95.c061e6b6.js"><link rel="prefetch" href="/assets/js/96.72f306dd.js"><link rel="prefetch" href="/assets/js/97.01e2b3e9.js"><link rel="prefetch" href="/assets/js/98.8a854f4d.js"><link rel="prefetch" href="/assets/js/99.7f5e066e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.dd0c7c90.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">复盘笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程语言" class="mobile-dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/java-core/" class="nav-link">
  Java 核心知识（In review）
</a></li><li class="dropdown-item"><!----> <a href="/language/java-concurrency/" class="nav-link">
  Java 并发编程
</a></li><li class="dropdown-item"><!----> <a href="/language/java-jvm/" class="nav-link router-link-active">
  Java JVM-虚拟机
</a></li><li class="dropdown-item"><!----> <a href="/language/scala-basis/" class="nav-link">
  Scala 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术框架" class="dropdown-title"><span class="title">技术框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="技术框架" class="mobile-dropdown-title"><span class="title">技术框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/spark-basis/" class="nav-link">
  Spark 基础（In review）
</a></li><li class="dropdown-item"><!----> <a href="/framework/flink-basis/" class="nav-link">
  Flink 基础（In review）
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法设计与理论" class="dropdown-title"><span class="title">算法设计与理论</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法设计与理论" class="mobile-dropdown-title"><span class="title">算法设计与理论</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithm/data-structures/" class="nav-link">
  数据结构（In review）
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevOps" class="dropdown-title"><span class="title">DevOps</span> <span class="arrow down"></span></button> <button type="button" aria-label="DevOps" class="mobile-dropdown-title"><span class="title">DevOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/devops/git/" class="nav-link">
  Git（In review）
</a></li><li class="dropdown-item"><!----> <a href="/devops/dev-tools/" class="nav-link">
  工具收藏系列
</a></li></ul></div></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试题
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于" class="mobile-dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/学习方法.html" class="nav-link">
  学习方法
</a></li><li class="dropdown-item"><!----> <a href="/about/贡献说明.html" class="nav-link">
  贡献说明
</a></li></ul></div></div> <a href="https://github.com/GourdErwa/review-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程语言" class="mobile-dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/java-core/" class="nav-link">
  Java 核心知识（In review）
</a></li><li class="dropdown-item"><!----> <a href="/language/java-concurrency/" class="nav-link">
  Java 并发编程
</a></li><li class="dropdown-item"><!----> <a href="/language/java-jvm/" class="nav-link router-link-active">
  Java JVM-虚拟机
</a></li><li class="dropdown-item"><!----> <a href="/language/scala-basis/" class="nav-link">
  Scala 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术框架" class="dropdown-title"><span class="title">技术框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="技术框架" class="mobile-dropdown-title"><span class="title">技术框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/spark-basis/" class="nav-link">
  Spark 基础（In review）
</a></li><li class="dropdown-item"><!----> <a href="/framework/flink-basis/" class="nav-link">
  Flink 基础（In review）
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法设计与理论" class="dropdown-title"><span class="title">算法设计与理论</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法设计与理论" class="mobile-dropdown-title"><span class="title">算法设计与理论</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithm/data-structures/" class="nav-link">
  数据结构（In review）
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevOps" class="dropdown-title"><span class="title">DevOps</span> <span class="arrow down"></span></button> <button type="button" aria-label="DevOps" class="mobile-dropdown-title"><span class="title">DevOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/devops/git/" class="nav-link">
  Git（In review）
</a></li><li class="dropdown-item"><!----> <a href="/devops/dev-tools/" class="nav-link">
  工具收藏系列
</a></li></ul></div></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试题
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于" class="mobile-dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/学习方法.html" class="nav-link">
  学习方法
</a></li><li class="dropdown-item"><!----> <a href="/about/贡献说明.html" class="nav-link">
  贡献说明
</a></li></ul></div></div> <a href="https://github.com/GourdErwa/review-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java JVM-内存管理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/language/java-jvm/运行时内存数据区域.html" class="sidebar-link">运行时内存数据区域</a></li><li><a href="/language/java-jvm/引用有什么用.html" class="sidebar-link">引用有什么用</a></li><li><a href="/language/java-jvm/JDK9-类加载机制及双亲委派模式.html" class="sidebar-link">JDK9-类加载机制及双亲委派模式</a></li><li><a href="/language/java-jvm/从虚拟机的角度看对象的创建与访问.html" class="sidebar-link">从虚拟机的角度看对象的创建与访问</a></li><li><a href="/language/java-jvm/从程序员的角度看对象初始化过程与内存分配.html" class="sidebar-link">从程序员的角度看对象初始化过程，变量加载顺序及内存分配</a></li><li><a href="/language/java-jvm/对象的死亡过程.html" class="sidebar-link">对象的死亡过程</a></li><li><a href="/language/java-jvm/垃圾收集算法.html" class="sidebar-link">垃圾收集算法</a></li><li><a href="/language/java-jvm/JDK11-7个垃圾收集器.html" class="sidebar-link">JDK11-7个垃圾收集器</a></li><li><a href="/language/java-jvm/OpenJDK12-Shenandoah收集器.html" class="sidebar-link">OpenJDK 12-Shenandoah 收集器</a></li><li><a href="/language/java-jvm/OracleJDK11-ZGC收集器.html" class="sidebar-link">OracleJDK 11-ZGC 收集器</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Java JVM-性能监控、故障处理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/language/java-jvm/故障诊断-OutOfMemoryError.html" class="sidebar-link">故障诊断-OutOfMemoryError</a></li><li><a href="/language/java-jvm/诊断命令处理工具大全.html" class="sidebar-link">诊断命令处理工具大全</a></li><li><a href="/language/java-jvm/故障诊断-高CPU占用.html" class="sidebar-link">故障诊断-高CPU占用</a></li><li><a href="/language/java-jvm/故障诊断-高内存占用、内存泄漏.html" class="sidebar-link">故障诊断-高内存占用、内存泄漏</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Java JVM-虚拟机子系统</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/language/java-jvm/字节码指令-指令表收录.html" class="sidebar-link">字节码指令-指令表收录</a></li><li><a href="/language/java-jvm/运行时栈帧结构.html" class="active sidebar-link">运行时栈帧结构</a></li><li><a href="/language/java-jvm/从一段代码分析虚拟机内存分配.html" class="sidebar-link">从一段代码分析虚拟机内存分配</a></li><li><a href="/language/java-jvm/为什么字节码new指令后执行dup指令.html" class="sidebar-link">为什么 new 指令后执行 dup 指令</a></li><li><a href="/language/java-jvm/从方法调用的角度分析重载重写的本质.html" class="sidebar-link">从方法调用的角度分析重载重写的本质</a></li><li><a href="/language/java-jvm/动态方法之方法句柄 MethodHandle.html" class="sidebar-link">动态方法之方法句柄 MethodHandle</a></li><li><a href="/language/java-jvm/动态方法调用指令invokedynamic.html" class="sidebar-link">动态方法调用指令 invokedynamic</a></li><li><a href="/language/java-jvm/代码是怎么运行起来的.html" class="sidebar-link">代码是怎么运行起来的</a></li><li><a href="/language/java-jvm/虚拟机编译器性能增强优化技术.html" class="sidebar-link">虚拟机编译器性能增强优化技术</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p>专栏原创出处：<a href="https://github.com/GourdErwa/review-notes/tree/master/language/java-jvm" target="_blank" rel="noopener noreferrer">github-源笔记文件 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ，<a href="https://github.com/GourdErwa/java-advanced/tree/master/java-jvm" target="_blank" rel="noopener noreferrer">github-源码 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，欢迎 Star，转载请附上原文出处链接和本声明。</p></blockquote> <p>Java JVM-虚拟机专栏系列笔记，系统性学习可访问个人复盘笔记-技术博客 <a href="https://review-notes.top/language/java-jvm/" target="_blank" rel="noopener noreferrer">Java JVM-虚拟机 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p></p><div class="table-of-contents"><ul><li><a href="#一、前言">一、前言</a></li><li><a href="#二、运行时栈帧结构概念图">二、运行时栈帧结构概念图</a></li><li><a href="#三、-局部变量表">三、 局部变量表</a></li><li><a href="#四、-操作栈">四、 操作栈</a></li><li><a href="#五、-动态连接">五、 动态连接</a></li><li><a href="#六、-方法返回地址">六、 方法返回地址</a></li><li><a href="#七、字节码分析实战">七、字节码分析实战</a></li><li><a href="#参考">参考</a></li></ul></div><p></p> <h2 id="一、前言"><a href="#一、前言" class="header-anchor">#</a> 一、前言</h2> <p>Java 虚拟机以方法作为最基本的执行单元，「栈帧」则是用于支持虚拟机进行方法调用和方法执行背后的数据结构，它也是虚拟机运行时数据区中的虚拟机栈的栈元素。</p> <p>栈帧存储了方法的局部变量表、操作栈、动态连接和方法返回地址等信息。每一个方法从调用开始至执行结束的过程，都对应着一个栈帧在虚拟机栈里面从入栈到出栈的过程。</p> <p><strong>大白话：</strong></p> <p>代码里面的每个方法都是一个栈帧，我们可以把一个方法链看着是一个个栈帧堆积在那，每调用一个方法就少一个栈帧。</p> <ul><li>方法里面的变量与运算操作通过 <em>局部变量表、操作栈</em> 完成。</li> <li>因为 Java 支持多态，所以运行时实际的调用通过 <em>动态连接</em> 完成。</li> <li>方法完成后可能会有返回值，返回值在哪通过 <em>方法返回地址</em> 指定。</li></ul> <h2 id="二、运行时栈帧结构概念图"><a href="#二、运行时栈帧结构概念图" class="header-anchor">#</a> 二、运行时栈帧结构概念图</h2> <div align="center"><img src="https://blog-review-notes.oss-cn-beijing.aliyuncs.com/language/java-jvm/_images/虚拟机-栈帧的概念结构.jpeg"></div> <h2 id="三、-局部变量表"><a href="#三、-局部变量表" class="header-anchor">#</a> 三、 局部变量表</h2> <p>局部变量表是一组变量值的存储空间，用于存放方法参数和方法内部定义的局部变量。</p> <p><strong>1) 变量槽</strong></p> <p>局部变量表的容量以变量槽为最小单位，boolean、byte、char、short、int、float、reference 或 returnAddress 类型的数据都可以使用 32 位或更小的物理内存来存储。
64 位的数据类型只有 long 和 double 两种。</p> <p>Java 虚拟机通过索引定位的方式使用局部变量表，索引值的范围是从 0 开始至局部变量表最大的变量槽数量。</p> <ul><li>如果访问的是 32 位数据类型的变量，索引 N 就代表了使用第 N 个变量槽</li> <li>如果访问的是 64 位数据类型的变量，则说明会同时使用第 N 和 N+1 两个变量槽</li></ul> <p><strong>2) 方法调用时参数的传递</strong></p> <p>当一个方法被调用时，Java 虚拟机会使用局部变量表来完成参数值到参数变量列表的传递过程，即实参到形参的传递。</p> <p>如果执行的是实例方法（没有被 static 修饰的方法），那局部变量表中第 0 位索引的变量槽默认是用于传递方法所属对象实例的引用，在方法中可以通过关键字「this」来访问到这个隐含的参数（字节码 aload_0）。</p> <p>其余参数则按照参数表顺序排列，占用从 1 开始的局部变量槽，参数表分配完毕后，再根据方法体内部定义的变量顺序和作用域分配其余的变量槽。</p> <p><strong>3) 变量槽是可以重用的</strong></p> <p>为了尽可能节省栈帧耗用的内存空间，局部变量表中的变量槽是可以重用的，方法体中定义的变量，其作用域并不一定会覆盖整个方法体，如果当前字节码 PC 计数器的值已经超出了某个变量的作用域，那这个变量对应的变量槽就可以交给其他变量来重用。</p> <p>缺点：影响到系统的垃圾收集行为。比如：大方法占用较多的 Slot，执行完该方法的作用域后没有对 Slot 赋值或者清空设置 null 值，垃圾回收器便不能及时的回收该内存。</p> <p><strong>4) 局部变量定义后必须赋值</strong></p> <p>局部变量定义后必须赋值。因为它不像类变量一样存在「准备阶段初始化赋值」「初始化阶段程序赋值」。</p> <h2 id="四、-操作栈"><a href="#四、-操作栈" class="header-anchor">#</a> 四、 操作栈</h2> <p>操作栈也常被称为操作数栈，它是一个后入先出（LIFO）栈。</p> <p><strong>1) 操作栈容量</strong></p> <p>操作栈的每一个元素都可以是包括 long 和 double 在内的任意 Java 数据类型。Javac 编译器的数据流分析工作保证了在方法执行的任何时候，操作栈的深度都不会超过在 max_stacks 数据项中设定的最大值。</p> <ul><li>32 位数据类型所占的栈容量为 1</li> <li>64 位数据类型所占的栈容量为 2</li></ul> <p><strong>2) 操作栈的操作过程</strong></p> <p>当一个方法刚刚开始执行的时候，这个方法的操作栈是空的，在方法的执行过程中，会有各种字节码指令往操作栈中写入和提取内容，也就是出栈和入栈操作。</p> <ul><li>比如在做算术运算的时候，是通过将运算涉及的操作栈压入栈顶后调用运算指令来进行的</li> <li>比如在调用其他方法的时候，是通过操作栈来进行方法参数的传递</li></ul> <blockquote><p>例如：整数加法的字节码指令 iadd，这条指令在运行的时候要求操作栈中最接近栈顶的两个元素已经存入了两个 int 型的数值，当执行这个指令时，会把这两个 int 值出栈并相加，然后将相加的结果重新入栈。</p></blockquote> <p><strong>3) 栈帧的局部优化</strong></p> <p>在虚拟机概念模型中，栈帧之间是独立的。但是实际虚拟机实现时会做一些优化处理，让两个栈帧的「部分操作栈」、「部分局部变量表出现重叠」，这样可以节省一部分空间，方法调用时直接可以共享一部分数据，无须进行额外的参数复制。</p> <div align="center"><img src="https://blog-review-notes.oss-cn-beijing.aliyuncs.com/language/java-jvm/_images/虚拟机-两个栈帧之间的数据共享.jpeg" height="550px"></div> <h2 id="五、-动态连接"><a href="#五、-动态连接" class="header-anchor">#</a> 五、 动态连接</h2> <p>每个栈帧都包含一个指向运行时常量池中该栈帧所属方法的引用，持有这个引用是为了支持方法调用过程中的动态连接。</p> <p>Class 文件的常量池中存有大量的符号引用，字节码中的方法调用指令就以常量池里指向方法的符号引用作为参数。这些符号引用：</p> <ul><li>一部分会在类加载阶段或者第一次使用的时候就被转化为直接引用，这种转化被称为「静态解析」</li> <li>另外一部分将在每一次运行期间都转化为直接引用，这部分就称为「动态连接」</li></ul> <h2 id="六、-方法返回地址"><a href="#六、-方法返回地址" class="header-anchor">#</a> 六、 方法返回地址</h2> <p>无论采用任何退出方式，在方法退出之后，都需要返回到方法被调用的位置，程序才能继续执行，方法返回时可能需要在栈帧中保存一些信息。正常调用退出时有返回值，异常调用提出时一般没有返回值。</p> <p><strong>1) 方法退出方式-正常调用完成</strong></p> <p>执行引擎遇到任意一个方法返回的字节码指令，这时候可能会有返回值传递给上层的方法调用者，方法是否有返回值以及返回值的类型将根据遇到何种方法返回指令来决定。</p> <p>主调方法的 PC 计数器的值就可以作为「返回地址」，栈帧中很可能会保存这个计数器值。</p> <p><strong>2) 方法退出方式-异常调用完成</strong></p> <p>在方法执行的过程中遇到了异常，并且这个异常没有在方法体内得到妥善处理。
无论是 Java 虚拟机内部产生的异常，还是代码中使用 athrow 字节码指令产生的异常，只要在本方法的异常表中没有搜索到匹配的异常处理器，就会导致方法退出。</p> <p>返回地址是要通过异常处理器表来确定的，栈帧中就一般不会保存这部分信息。</p> <p><strong>3) 方法退出的过程</strong></p> <p>方法退出的过程实际上等同于把当前栈帧出栈，因此退出时可能执行的操作有：</p> <ul><li>恢复上层方法的局部变量表和操作栈</li> <li>把返回值（如果有的话）压入调用者栈帧的操作栈中</li> <li>调整 PC 计数器的值以指向方法调用指令后面的一条指令等</li></ul> <blockquote><p>这里写的「可能」是由于这是基于概念模型的讨论，只有具体到某一款 Java 虚拟机实现，会执行哪些操作才能确定下来。</p></blockquote> <h2 id="七、字节码分析实战"><a href="#七、字节码分析实战" class="header-anchor">#</a> 七、字节码分析实战</h2> <p>写一个简单的程序运算，calculation 方法使用一个运算结果与类变量 threshold 进行比较。其中对分母做了不为 0 校验。</p> <p>编译后查看字节码进行分析，进一步加强对「栈帧」的理解。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StackFrameExample</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> threshold<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">StackFrameExample</span><span class="token punctuation">(</span><span class="token keyword">int</span> threshold<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>threshold <span class="token operator">=</span> threshold<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">calculation</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> sum <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sum <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;zero ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>c <span class="token operator">/</span> sum<span class="token punctuation">)</span> <span class="token operator">&gt;</span> threshold<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>执行 <code>javap -c -p -v StackFrameExample.class</code> 查看字节码如下：</p> <p>内容较多建议分屏与源代码对应查看，参考翻译-<a href="https://blog.csdn.net/xiaohulunb/article/details/103976523" target="_blank" rel="noopener noreferrer">字节码指令集<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StackFrameExample</span>
  minor version<span class="token operator">:</span> <span class="token number">0</span>
  major version<span class="token operator">:</span> <span class="token number">55</span>
  flags<span class="token operator">:</span> ACC_PUBLIC<span class="token punctuation">,</span> ACC_SUPER
<span class="token class-name">Constant</span> pool<span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">&gt;</span> 常量池
   #<span class="token number">1</span> <span class="token operator">=</span> <span class="token class-name">Methodref</span>          #<span class="token number">7.</span>#<span class="token number">26</span>         <span class="token comment">// java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span>
   #<span class="token number">2</span> <span class="token operator">=</span> <span class="token class-name">Fieldref</span>           #<span class="token number">6.</span>#<span class="token number">27</span>         <span class="token comment">// io/gourd/java/jvm/bytecode/StackFrameExample.threshold:I</span>
   #<span class="token number">3</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">28</span>            <span class="token comment">// java/lang/IllegalArgumentException</span>
   #<span class="token number">4</span> <span class="token operator">=</span> <span class="token class-name">String</span>             #<span class="token number">29</span>            <span class="token comment">// zero ...</span>
   #<span class="token number">5</span> <span class="token operator">=</span> <span class="token class-name">Methodref</span>          #<span class="token number">3.</span>#<span class="token number">30</span>         <span class="token comment">// java/lang/IllegalArgumentException.&quot;&lt;init&gt;&quot;:(Ljava/lang/String;)V</span>
   #<span class="token number">6</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">31</span>            <span class="token comment">// io/gourd/java/jvm/bytecode/StackFrameExample</span>
   #<span class="token number">7</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">32</span>            <span class="token comment">// java/lang/Object</span>
   #<span class="token number">8</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               threshold
   #<span class="token number">9</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">I</span>
  #<span class="token number">10</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token generics"><span class="token punctuation">&lt;</span>init<span class="token punctuation">&gt;</span></span>
  #<span class="token number">11</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token class-name">V</span>
  #<span class="token number">12</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">Code</span>
  #<span class="token number">13</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">LineNumberTable</span>
  #<span class="token number">14</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">LocalVariableTable</span>
  #<span class="token number">15</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token keyword">this</span>
  #<span class="token number">16</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">Lio</span><span class="token operator">/</span>gourd<span class="token operator">/</span>java<span class="token operator">/</span>jvm<span class="token operator">/</span>bytecode<span class="token operator">/</span><span class="token class-name">StackFrameExample</span><span class="token punctuation">;</span>
  #<span class="token number">17</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               calculation
  #<span class="token number">18</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token punctuation">(</span>II<span class="token punctuation">)</span><span class="token class-name">Z</span>
  #<span class="token number">19</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               a
  #<span class="token number">20</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               b
  #<span class="token number">21</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               c
  #<span class="token number">22</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               sum
  #<span class="token number">23</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">StackMapTable</span>
  #<span class="token number">24</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">SourceFile</span>
  #<span class="token number">25</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">StackFrameExample</span><span class="token punctuation">.</span>java
  #<span class="token number">26</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">10</span><span class="token operator">:</span>#<span class="token number">33</span>        <span class="token comment">// &quot;&lt;init&gt;&quot;:()V</span>
  #<span class="token number">27</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">8</span><span class="token operator">:</span>#<span class="token number">9</span>          <span class="token comment">// threshold:I</span>
  #<span class="token number">28</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">IllegalArgumentException</span>
  #<span class="token number">29</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               zero <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  #<span class="token number">30</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">10</span><span class="token operator">:</span>#<span class="token number">34</span>        <span class="token comment">// &quot;&lt;init&gt;&quot;:(Ljava/lang/String;)V</span>
  #<span class="token number">31</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               io<span class="token operator">/</span>gourd<span class="token operator">/</span>java<span class="token operator">/</span>jvm<span class="token operator">/</span>bytecode<span class="token operator">/</span><span class="token class-name">StackFrameExample</span>
  #<span class="token number">32</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span>
  #<span class="token number">33</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>
  #<span class="token number">34</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span>
<span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> threshold<span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token class-name">I</span>
    flags<span class="token operator">:</span> ACC_PRIVATE

  <span class="token keyword">public</span> <span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>gourd<span class="token punctuation">.</span>java<span class="token punctuation">.</span>jvm<span class="token punctuation">.</span>bytecode<span class="token punctuation">.</span></span>StackFrameExample</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token class-name">V</span>
    flags<span class="token operator">:</span> ACC_PUBLIC
    <span class="token class-name">Code</span><span class="token operator">:</span>
      stack<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> locals<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> args_size<span class="token operator">=</span><span class="token number">2</span>
       <span class="token number">0</span><span class="token operator">:</span> aload_0          <span class="token operator">=</span><span class="token operator">&gt;</span><span class="token keyword">this</span> 引用本地变量推送至栈顶
       <span class="token number">1</span><span class="token operator">:</span> invokespecial #<span class="token number">1</span> <span class="token comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V 调用父类构造函数 this.super()</span>
       <span class="token number">4</span><span class="token operator">:</span> aload_0          <span class="token operator">=</span><span class="token operator">&gt;</span><span class="token keyword">this</span> 引用本地变量推送至栈顶
       <span class="token number">5</span><span class="token operator">:</span> iload_1          <span class="token operator">=</span><span class="token operator">&gt;</span> 构造函数的 threshold 本地变量推送至栈顶
       <span class="token number">6</span><span class="token operator">:</span> putfield      #<span class="token number">2</span>  <span class="token comment">// Field threshold:I  为指定类的实例域 threshold 赋值</span>
       <span class="token number">9</span><span class="token operator">:</span> <span class="token keyword">return</span>           <span class="token operator">=</span><span class="token operator">&gt;</span> 从当前方法返回 <span class="token keyword">void</span>

  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">calculation</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token punctuation">(</span>II<span class="token punctuation">)</span><span class="token class-name">Z</span>
    flags<span class="token operator">:</span> ACC_PUBLIC
    <span class="token class-name">Code</span><span class="token operator">:</span>
      stack<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> locals<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> args_size<span class="token operator">=</span><span class="token number">3</span> <span class="token operator">=</span><span class="token operator">&gt;</span>
       <span class="token number">0</span><span class="token operator">:</span> sipush        <span class="token number">300</span> <span class="token operator">=</span><span class="token operator">&gt;</span> 将一个短整型常量 <span class="token number">300</span> 推送至栈顶
       <span class="token number">3</span><span class="token operator">:</span> istore_3          <span class="token operator">=</span><span class="token operator">&gt;</span> 将栈顶 c <span class="token operator">=</span> <span class="token number">300</span> 数值存入第四个本地变量（<span class="token keyword">this</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b）已经占了 <span class="token number">3</span> 个槽位
       <span class="token number">4</span><span class="token operator">:</span> iload_1           <span class="token operator">=</span><span class="token operator">&gt;</span> 将第二个 <span class="token keyword">int</span> 型本地变量 a 推送至栈顶
       <span class="token number">5</span><span class="token operator">:</span> iload_2           <span class="token operator">=</span><span class="token operator">&gt;</span> 将第二个 <span class="token keyword">int</span> 型本地变量 b 推送至栈顶
       <span class="token number">6</span><span class="token operator">:</span> iadd              <span class="token operator">=</span><span class="token operator">&gt;</span> 将栈顶两 <span class="token keyword">int</span> 型数值 a、b 相加并将结果压入栈顶
       <span class="token number">7</span><span class="token operator">:</span> istore        <span class="token number">4</span>   <span class="token operator">=</span><span class="token operator">&gt;</span> 将栈顶 <span class="token keyword">int</span> 型数值存入指定本地变量 sum （第五个本地变量，槽位为 <span class="token number">4</span>）
       <span class="token number">9</span><span class="token operator">:</span> iload         <span class="token number">4</span>   <span class="token operator">=</span><span class="token operator">&gt;</span> 将指定的 <span class="token keyword">int</span> 型本地变量（槽位为 <span class="token number">4</span> 的 sum）推送至栈顶
      <span class="token number">11</span><span class="token operator">:</span> ifne          <span class="token number">24</span>  <span class="token operator">=</span><span class="token operator">&gt;</span> 当栈顶 <span class="token keyword">int</span> 型数值 sum 不等于 <span class="token number">0</span> 时跳转到<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> 字节码
      <span class="token number">14</span><span class="token operator">:</span> <span class="token keyword">new</span>           #<span class="token number">3</span>  <span class="token comment">// class java/lang/IllegalArgumentException 开始创建异常对象</span>
      <span class="token number">17</span><span class="token operator">:</span> dup               <span class="token operator">=</span><span class="token operator">&gt;</span> 复制栈顶数值并将复制值压入栈顶
      <span class="token number">18</span><span class="token operator">:</span> ldc           #<span class="token number">4</span>  <span class="token comment">// String zero ... 将 String 型常量值（zero ...）从常量池中推送至栈顶</span>
      <span class="token number">20</span><span class="token operator">:</span> invokespecial #<span class="token number">5</span>  <span class="token comment">// 调用超类构建方法, 实例初始化方法</span>
      <span class="token number">23</span><span class="token operator">:</span> athrow            <span class="token operator">=</span><span class="token operator">&gt;</span> 将栈顶的异常抛出
      <span class="token number">24</span><span class="token operator">:</span> iload_3           <span class="token operator">=</span><span class="token operator">&gt;</span> 将第四个 <span class="token keyword">int</span> 型本地变量 c（槽位为 <span class="token number">3</span>）推送至栈顶
      <span class="token number">25</span><span class="token operator">:</span> iload         <span class="token number">4</span>   <span class="token operator">=</span><span class="token operator">&gt;</span> 将第五个 <span class="token keyword">int</span> 型本地变量 sum（槽位为 <span class="token number">4</span>）推送至栈顶
      <span class="token number">27</span><span class="token operator">:</span> idiv              <span class="token operator">=</span><span class="token operator">&gt;</span> 将栈顶两 <span class="token keyword">int</span> 型数值相除（c<span class="token operator">/</span>sum）并将结果压入栈顶
      <span class="token number">28</span><span class="token operator">:</span> aload_0           <span class="token operator">=</span><span class="token operator">&gt;</span><span class="token keyword">this</span> 引用本地变量推送至栈顶
      <span class="token number">29</span><span class="token operator">:</span> getfield      #<span class="token number">2</span>   <span class="token comment">// Field threshold:I  获取类的实例域 threshold</span>
      <span class="token number">32</span><span class="token operator">:</span> if_icmple     <span class="token number">39</span>  <span class="token operator">=</span><span class="token operator">&gt;</span> 比较栈顶两 <span class="token keyword">int</span> 型数值大小（<span class="token punctuation">(</span>c <span class="token operator">/</span> sum<span class="token punctuation">)</span> <span class="token operator">&gt;</span> threshold）<span class="token punctuation">,</span> 当结果小于等于 <span class="token number">0</span> 时跳转<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> 字节码
      <span class="token number">35</span><span class="token operator">:</span> iconst_1          <span class="token operator">=</span><span class="token operator">&gt;</span> 将 <span class="token keyword">int</span> 型 <span class="token number">1</span> 推送至栈顶（<span class="token boolean">true</span>）
      <span class="token number">36</span><span class="token operator">:</span> <span class="token keyword">goto</span>          <span class="token number">40</span>  <span class="token operator">=</span><span class="token operator">&gt;</span> 无条件跳转
      <span class="token number">39</span><span class="token operator">:</span> iconst_0          <span class="token operator">=</span><span class="token operator">&gt;</span> 将 <span class="token keyword">int</span> 型 <span class="token number">0</span> 推送至栈顶（<span class="token boolean">false</span>）
      <span class="token number">40</span><span class="token operator">:</span> ireturn           <span class="token operator">=</span><span class="token operator">&gt;</span> 从当前方法返回 <span class="token keyword">int</span>
      <span class="token class-name">LineNumberTable</span><span class="token operator">:</span><span class="token operator">=</span><span class="token operator">&gt;</span> 表存放方法的行号信息
        line <span class="token number">17</span><span class="token operator">:</span> <span class="token number">0</span>
        line <span class="token number">18</span><span class="token operator">:</span> <span class="token number">4</span>
        line <span class="token number">19</span><span class="token operator">:</span> <span class="token number">9</span>
        line <span class="token number">20</span><span class="token operator">:</span> <span class="token number">14</span>
        line <span class="token number">22</span><span class="token operator">:</span> <span class="token number">24</span>
      <span class="token class-name">LocalVariableTable</span><span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">&gt;</span> 存放方法的局部变量信息，与上面指令操作一一对应，重点是第一个槽位是 <span class="token keyword">this</span> 引用
        <span class="token class-name">Start</span>  <span class="token class-name">Length</span>  <span class="token class-name">Slot</span>  <span class="token class-name">Name</span>   <span class="token class-name">Signature</span>
            <span class="token number">0</span>      <span class="token number">41</span>     <span class="token number">0</span>  <span class="token keyword">this</span>   <span class="token class-name">Lio</span><span class="token operator">/</span>gourd<span class="token operator">/</span>java<span class="token operator">/</span>jvm<span class="token operator">/</span>bytecode<span class="token operator">/</span><span class="token class-name">StackFrameExample</span><span class="token punctuation">;</span>
            <span class="token number">0</span>      <span class="token number">41</span>     <span class="token number">1</span>     a   <span class="token class-name">I</span>
            <span class="token number">0</span>      <span class="token number">41</span>     <span class="token number">2</span>     b   <span class="token class-name">I</span>
            <span class="token number">4</span>      <span class="token number">37</span>     <span class="token number">3</span>     c   <span class="token class-name">I</span>
            <span class="token number">9</span>      <span class="token number">32</span>     <span class="token number">4</span>   sum   <span class="token class-name">I</span>
      <span class="token class-name">StackMapTable</span><span class="token operator">:</span> number_of_entries <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">=</span><span class="token operator">&gt;</span> 栈图 
        frame_type <span class="token operator">=</span> <span class="token number">253</span>
          offset_delta <span class="token operator">=</span> <span class="token number">24</span>
              locals <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token punctuation">]</span>
              frame_type <span class="token operator">=</span> <span class="token number">14</span>
              frame_type <span class="token operator">=</span> <span class="token number">64</span>
              stack <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token keyword">int</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>疑问点一）：</strong> Code 中 <code>18: ldc #4</code> 的#4 表示什么？</p> <p>对应常量池的符号引用。上述中#4 表示常量池中<code>#29 = Utf8 zero ...</code>字符串</p> <p><strong>疑问点二）：</strong> aload_0 指令的意义？</p> <p>对于需要对象才能操作的方法、类成员变量等，我们需要先确定是哪个对象，然后在确定这个对象要执行的操作。</p> <ul><li>如果使用局部变量，直接操作数据槽</li> <li>如果使用类变量，先要拿到类的引用，再通过符号引用定位类成员</li> <li>每个非静态方法隐式的第一个参数默认是 this 对象，只是对我们程序来说看不到。因此第 0 个槽位的数据就是 this，直接使用 aload_0 指令进行压栈操作</li></ul> <p><strong>疑问点三）：</strong> calculation 方法明明返回 boolean ，为什么最终使用 ireturn 返回 int 型？</p> <p>为了减少指令集，使用 int 替代了 byte、short、char 和 boolean 的算数指令。这些类型可以向上转换不会丢失精度。</p> <p><strong>疑问点四）：</strong> StackMapTable-栈图是什么？</p> <p>感兴趣深入研究的可参考 <a href="https://docs.oracle.com/javase/specs/jvms/se13/html/jvms-4.html#jvms-4.7.4" target="_blank" rel="noopener noreferrer">虚拟机规范-StackMapTable<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li>《深入理解 Java 虚拟机：JVM 高级特性与最佳实践（第 3 版）》周志明 著</li> <li>字节码翻译字典-<a href="https://blog.csdn.net/xiaohulunb/article/details/103976523" target="_blank" rel="noopener noreferrer">字节码指令集<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后修改时间:</span> <span class="time">2/17/2020, 4:43:04 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/language/java-jvm/字节码指令-指令表收录.html" class="prev">
        字节码指令-指令表收录
      </a></span> <span class="next"><a href="/language/java-jvm/从一段代码分析虚拟机内存分配.html">
        从一段代码分析虚拟机内存分配
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.37e3de20.js" defer></script><script src="/assets/js/2.62143406.js" defer></script><script src="/assets/js/190.a92b0d15.js" defer></script>
  </body>
</html>
