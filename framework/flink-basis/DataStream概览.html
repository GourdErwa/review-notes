<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>复盘笔记</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="review notes">
    
    <link rel="preload" href="/assets/css/0.styles.dd0c7c90.css" as="style"><link rel="preload" href="/assets/js/app.7b04417e.js" as="script"><link rel="preload" href="/assets/js/2.62143406.js" as="script"><link rel="preload" href="/assets/js/72.c7d09a18.js" as="script"><link rel="prefetch" href="/assets/js/10.9b1b0f20.js"><link rel="prefetch" href="/assets/js/100.b87810ee.js"><link rel="prefetch" href="/assets/js/101.f3459c7a.js"><link rel="prefetch" href="/assets/js/102.dc3295b0.js"><link rel="prefetch" href="/assets/js/103.2a5154a2.js"><link rel="prefetch" href="/assets/js/104.4f5e9f61.js"><link rel="prefetch" href="/assets/js/105.05f0c461.js"><link rel="prefetch" href="/assets/js/106.616d5f80.js"><link rel="prefetch" href="/assets/js/107.9fb68efc.js"><link rel="prefetch" href="/assets/js/108.c6235b18.js"><link rel="prefetch" href="/assets/js/109.4ac0bd39.js"><link rel="prefetch" href="/assets/js/11.b9c4e989.js"><link rel="prefetch" href="/assets/js/110.18a09e3b.js"><link rel="prefetch" href="/assets/js/111.0699d61c.js"><link rel="prefetch" href="/assets/js/112.06e1ac1f.js"><link rel="prefetch" href="/assets/js/113.cf8cab2c.js"><link rel="prefetch" href="/assets/js/114.8af4627a.js"><link rel="prefetch" href="/assets/js/115.06936c65.js"><link rel="prefetch" href="/assets/js/116.e4c46035.js"><link rel="prefetch" href="/assets/js/117.a3777062.js"><link rel="prefetch" href="/assets/js/118.22738a5c.js"><link rel="prefetch" href="/assets/js/119.71000744.js"><link rel="prefetch" href="/assets/js/12.84e0b692.js"><link rel="prefetch" href="/assets/js/120.34eaac50.js"><link rel="prefetch" href="/assets/js/121.a6874b8e.js"><link rel="prefetch" href="/assets/js/122.88872d53.js"><link rel="prefetch" href="/assets/js/123.ff333183.js"><link rel="prefetch" href="/assets/js/124.32a03278.js"><link rel="prefetch" href="/assets/js/125.05fb752f.js"><link rel="prefetch" href="/assets/js/126.2cbaaeef.js"><link rel="prefetch" href="/assets/js/127.c6e6a074.js"><link rel="prefetch" href="/assets/js/128.d5e9e57c.js"><link rel="prefetch" href="/assets/js/129.e0c4f466.js"><link rel="prefetch" href="/assets/js/13.84cf0020.js"><link rel="prefetch" href="/assets/js/130.e9b1d4d4.js"><link rel="prefetch" href="/assets/js/131.fe74e3f8.js"><link rel="prefetch" href="/assets/js/132.281f9222.js"><link rel="prefetch" href="/assets/js/133.c7ee1067.js"><link rel="prefetch" href="/assets/js/134.65540b92.js"><link rel="prefetch" href="/assets/js/135.a1ff602f.js"><link rel="prefetch" href="/assets/js/136.4979afa2.js"><link rel="prefetch" href="/assets/js/137.828d83b7.js"><link rel="prefetch" href="/assets/js/138.8d748933.js"><link rel="prefetch" href="/assets/js/139.629de132.js"><link rel="prefetch" href="/assets/js/14.8f7a4e4b.js"><link rel="prefetch" href="/assets/js/140.60b469d1.js"><link rel="prefetch" href="/assets/js/141.91b410ce.js"><link rel="prefetch" href="/assets/js/142.4bd96f30.js"><link rel="prefetch" href="/assets/js/143.5078935d.js"><link rel="prefetch" href="/assets/js/144.2548a499.js"><link rel="prefetch" href="/assets/js/145.67949b20.js"><link rel="prefetch" href="/assets/js/146.235e5b2f.js"><link rel="prefetch" href="/assets/js/147.f9df9c16.js"><link rel="prefetch" href="/assets/js/148.3d5fe579.js"><link rel="prefetch" href="/assets/js/149.18f4672c.js"><link rel="prefetch" href="/assets/js/15.cf0ac5e4.js"><link rel="prefetch" href="/assets/js/150.7f002976.js"><link rel="prefetch" href="/assets/js/151.d538868b.js"><link rel="prefetch" href="/assets/js/152.1dc3bb8e.js"><link rel="prefetch" href="/assets/js/153.a02015b9.js"><link rel="prefetch" href="/assets/js/154.f0431c10.js"><link rel="prefetch" href="/assets/js/155.f0038718.js"><link rel="prefetch" href="/assets/js/156.f2d7d6a3.js"><link rel="prefetch" href="/assets/js/157.299ba0e3.js"><link rel="prefetch" href="/assets/js/158.0e41d0d7.js"><link rel="prefetch" href="/assets/js/159.e4cc4fc0.js"><link rel="prefetch" href="/assets/js/16.5484a898.js"><link rel="prefetch" href="/assets/js/160.28e9a560.js"><link rel="prefetch" href="/assets/js/161.1b738f0d.js"><link rel="prefetch" href="/assets/js/162.b1c73121.js"><link rel="prefetch" href="/assets/js/163.90d1efbc.js"><link rel="prefetch" href="/assets/js/164.bafd0939.js"><link rel="prefetch" href="/assets/js/165.0a0a6c06.js"><link rel="prefetch" href="/assets/js/166.86bb463a.js"><link rel="prefetch" href="/assets/js/167.371cd42a.js"><link rel="prefetch" href="/assets/js/168.9c8ab290.js"><link rel="prefetch" href="/assets/js/169.89ad6868.js"><link rel="prefetch" href="/assets/js/17.7d0e2fc4.js"><link rel="prefetch" href="/assets/js/170.d7996188.js"><link rel="prefetch" href="/assets/js/171.537d109a.js"><link rel="prefetch" href="/assets/js/172.e428c6dd.js"><link rel="prefetch" href="/assets/js/173.cba40240.js"><link rel="prefetch" href="/assets/js/174.61c05f37.js"><link rel="prefetch" href="/assets/js/175.e5ef21bc.js"><link rel="prefetch" href="/assets/js/176.7ee8bcde.js"><link rel="prefetch" href="/assets/js/177.e29afe5d.js"><link rel="prefetch" href="/assets/js/178.d18b4f98.js"><link rel="prefetch" href="/assets/js/179.f5fb63df.js"><link rel="prefetch" href="/assets/js/18.550159e4.js"><link rel="prefetch" href="/assets/js/180.767f65a1.js"><link rel="prefetch" href="/assets/js/181.cb542ebe.js"><link rel="prefetch" href="/assets/js/182.b900a0c7.js"><link rel="prefetch" href="/assets/js/183.0d017cc7.js"><link rel="prefetch" href="/assets/js/184.071f7d99.js"><link rel="prefetch" href="/assets/js/185.5d74de5e.js"><link rel="prefetch" href="/assets/js/186.a111c209.js"><link rel="prefetch" href="/assets/js/187.0bdbc707.js"><link rel="prefetch" href="/assets/js/188.5cdc2c0c.js"><link rel="prefetch" href="/assets/js/189.f19709d6.js"><link rel="prefetch" href="/assets/js/19.0d94e786.js"><link rel="prefetch" href="/assets/js/190.0e23b2b8.js"><link rel="prefetch" href="/assets/js/191.424b4b83.js"><link rel="prefetch" href="/assets/js/192.0c453959.js"><link rel="prefetch" href="/assets/js/193.39ad5859.js"><link rel="prefetch" href="/assets/js/194.54565937.js"><link rel="prefetch" href="/assets/js/195.6bb4fd98.js"><link rel="prefetch" href="/assets/js/196.11794306.js"><link rel="prefetch" href="/assets/js/197.88ec5625.js"><link rel="prefetch" href="/assets/js/198.eec9e334.js"><link rel="prefetch" href="/assets/js/199.131729dd.js"><link rel="prefetch" href="/assets/js/20.66082751.js"><link rel="prefetch" href="/assets/js/200.b26e448a.js"><link rel="prefetch" href="/assets/js/201.8def78fb.js"><link rel="prefetch" href="/assets/js/202.7cb96788.js"><link rel="prefetch" href="/assets/js/203.928dcf8a.js"><link rel="prefetch" href="/assets/js/204.85490ca6.js"><link rel="prefetch" href="/assets/js/205.2d30fb63.js"><link rel="prefetch" href="/assets/js/206.e5f31f8a.js"><link rel="prefetch" href="/assets/js/207.d20ac31b.js"><link rel="prefetch" href="/assets/js/208.14fca509.js"><link rel="prefetch" href="/assets/js/209.0f624548.js"><link rel="prefetch" href="/assets/js/21.99683f15.js"><link rel="prefetch" href="/assets/js/210.8c0c7024.js"><link rel="prefetch" href="/assets/js/211.49db3205.js"><link rel="prefetch" href="/assets/js/212.6dca0835.js"><link rel="prefetch" href="/assets/js/213.3a137459.js"><link rel="prefetch" href="/assets/js/214.d9692b18.js"><link rel="prefetch" href="/assets/js/215.70337d1e.js"><link rel="prefetch" href="/assets/js/216.c20874ad.js"><link rel="prefetch" href="/assets/js/217.f0d6d3f6.js"><link rel="prefetch" href="/assets/js/218.194b6a4d.js"><link rel="prefetch" href="/assets/js/219.ef16db09.js"><link rel="prefetch" href="/assets/js/22.da2f0036.js"><link rel="prefetch" href="/assets/js/220.28381a67.js"><link rel="prefetch" href="/assets/js/23.37f1d906.js"><link rel="prefetch" href="/assets/js/24.ca81b052.js"><link rel="prefetch" href="/assets/js/25.8e89d5e8.js"><link rel="prefetch" href="/assets/js/26.0562dfa1.js"><link rel="prefetch" href="/assets/js/27.3b2f1489.js"><link rel="prefetch" href="/assets/js/28.a929a8b9.js"><link rel="prefetch" href="/assets/js/29.6fd8e87a.js"><link rel="prefetch" href="/assets/js/3.3c670662.js"><link rel="prefetch" href="/assets/js/30.7e45c32c.js"><link rel="prefetch" href="/assets/js/31.4680f16a.js"><link rel="prefetch" href="/assets/js/32.e1e2ab6b.js"><link rel="prefetch" href="/assets/js/33.4a24ea5b.js"><link rel="prefetch" href="/assets/js/34.776427cd.js"><link rel="prefetch" href="/assets/js/35.49568a9b.js"><link rel="prefetch" href="/assets/js/36.5abe6a93.js"><link rel="prefetch" href="/assets/js/37.ddc05a05.js"><link rel="prefetch" href="/assets/js/38.21a1817c.js"><link rel="prefetch" href="/assets/js/39.4c18e8a1.js"><link rel="prefetch" href="/assets/js/4.57090dad.js"><link rel="prefetch" href="/assets/js/40.d6ae51e4.js"><link rel="prefetch" href="/assets/js/41.17d2f9a0.js"><link rel="prefetch" href="/assets/js/42.158a4f84.js"><link rel="prefetch" href="/assets/js/43.fbbd4966.js"><link rel="prefetch" href="/assets/js/44.a748f5ba.js"><link rel="prefetch" href="/assets/js/45.699215d9.js"><link rel="prefetch" href="/assets/js/46.cf333017.js"><link rel="prefetch" href="/assets/js/47.26868784.js"><link rel="prefetch" href="/assets/js/48.a6a5ac33.js"><link rel="prefetch" href="/assets/js/49.eb258f08.js"><link rel="prefetch" href="/assets/js/5.e471fe2c.js"><link rel="prefetch" href="/assets/js/50.c578ed4e.js"><link rel="prefetch" href="/assets/js/51.1e34b7ff.js"><link rel="prefetch" href="/assets/js/52.c6e8b614.js"><link rel="prefetch" href="/assets/js/53.d42b3eb4.js"><link rel="prefetch" href="/assets/js/54.229da863.js"><link rel="prefetch" href="/assets/js/55.e7fcc02c.js"><link rel="prefetch" href="/assets/js/56.6a4127b7.js"><link rel="prefetch" href="/assets/js/57.4edf7ccd.js"><link rel="prefetch" href="/assets/js/58.a2853e6b.js"><link rel="prefetch" href="/assets/js/59.ae0c653d.js"><link rel="prefetch" href="/assets/js/6.7cb80442.js"><link rel="prefetch" href="/assets/js/60.11e0e57a.js"><link rel="prefetch" href="/assets/js/61.89e52ce3.js"><link rel="prefetch" href="/assets/js/62.430e3527.js"><link rel="prefetch" href="/assets/js/63.d336cde1.js"><link rel="prefetch" href="/assets/js/64.ac69d9c6.js"><link rel="prefetch" href="/assets/js/65.9270b465.js"><link rel="prefetch" href="/assets/js/66.123a914b.js"><link rel="prefetch" href="/assets/js/67.0ebdd3b8.js"><link rel="prefetch" href="/assets/js/68.7fe4819e.js"><link rel="prefetch" href="/assets/js/69.a2cc745a.js"><link rel="prefetch" href="/assets/js/7.305109e0.js"><link rel="prefetch" href="/assets/js/70.74316f50.js"><link rel="prefetch" href="/assets/js/71.1261420f.js"><link rel="prefetch" href="/assets/js/73.4c87230e.js"><link rel="prefetch" href="/assets/js/74.236b9578.js"><link rel="prefetch" href="/assets/js/75.ed60e87a.js"><link rel="prefetch" href="/assets/js/76.c29bbf5a.js"><link rel="prefetch" href="/assets/js/77.f9dd0289.js"><link rel="prefetch" href="/assets/js/78.983b2daa.js"><link rel="prefetch" href="/assets/js/79.242b6d8a.js"><link rel="prefetch" href="/assets/js/8.de463583.js"><link rel="prefetch" href="/assets/js/80.319fd497.js"><link rel="prefetch" href="/assets/js/81.8cb22fc5.js"><link rel="prefetch" href="/assets/js/82.cd32fdf2.js"><link rel="prefetch" href="/assets/js/83.d8e28eb8.js"><link rel="prefetch" href="/assets/js/84.5bf0a8cd.js"><link rel="prefetch" href="/assets/js/85.caeab9f1.js"><link rel="prefetch" href="/assets/js/86.16af7ce2.js"><link rel="prefetch" href="/assets/js/87.940ece94.js"><link rel="prefetch" href="/assets/js/88.20643e58.js"><link rel="prefetch" href="/assets/js/89.809ab8ef.js"><link rel="prefetch" href="/assets/js/9.e40fd5db.js"><link rel="prefetch" href="/assets/js/90.35e0423f.js"><link rel="prefetch" href="/assets/js/91.3973f9b0.js"><link rel="prefetch" href="/assets/js/92.1167ca3c.js"><link rel="prefetch" href="/assets/js/93.85313159.js"><link rel="prefetch" href="/assets/js/94.01353c92.js"><link rel="prefetch" href="/assets/js/95.7c32c0c6.js"><link rel="prefetch" href="/assets/js/96.91396265.js"><link rel="prefetch" href="/assets/js/97.656a099f.js"><link rel="prefetch" href="/assets/js/98.513ee9c5.js"><link rel="prefetch" href="/assets/js/99.47ba70a4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.dd0c7c90.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">复盘笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程语言" class="mobile-dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/java-core/" class="nav-link">
  Java 核心知识（In review）
</a></li><li class="dropdown-item"><!----> <a href="/language/java-concurrency/" class="nav-link">
  Java 并发编程
</a></li><li class="dropdown-item"><!----> <a href="/language/java-jvm/" class="nav-link">
  Java JVM-虚拟机
</a></li><li class="dropdown-item"><!----> <a href="/language/scala-basis/" class="nav-link">
  Scala 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术框架" class="dropdown-title"><span class="title">技术框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="技术框架" class="mobile-dropdown-title"><span class="title">技术框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/spark-basis/" class="nav-link">
  Spark 基础（In review）
</a></li><li class="dropdown-item"><!----> <a href="/framework/flink-basis/" class="nav-link router-link-active">
  Flink 基础（In review）
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法设计与理论" class="dropdown-title"><span class="title">算法设计与理论</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法设计与理论" class="mobile-dropdown-title"><span class="title">算法设计与理论</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithm/data-structures/" class="nav-link">
  数据结构（In review）
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevOps" class="dropdown-title"><span class="title">DevOps</span> <span class="arrow down"></span></button> <button type="button" aria-label="DevOps" class="mobile-dropdown-title"><span class="title">DevOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/devops/git/" class="nav-link">
  Git（In review）
</a></li><li class="dropdown-item"><!----> <a href="/devops/dev-tools/" class="nav-link">
  工具收藏系列
</a></li></ul></div></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试题
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于" class="mobile-dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/学习方法.html" class="nav-link">
  学习方法
</a></li><li class="dropdown-item"><!----> <a href="/about/贡献说明.html" class="nav-link">
  贡献说明
</a></li></ul></div></div> <a href="https://github.com/GourdErwa/review-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程语言" class="mobile-dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/java-core/" class="nav-link">
  Java 核心知识（In review）
</a></li><li class="dropdown-item"><!----> <a href="/language/java-concurrency/" class="nav-link">
  Java 并发编程
</a></li><li class="dropdown-item"><!----> <a href="/language/java-jvm/" class="nav-link">
  Java JVM-虚拟机
</a></li><li class="dropdown-item"><!----> <a href="/language/scala-basis/" class="nav-link">
  Scala 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术框架" class="dropdown-title"><span class="title">技术框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="技术框架" class="mobile-dropdown-title"><span class="title">技术框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/spark-basis/" class="nav-link">
  Spark 基础（In review）
</a></li><li class="dropdown-item"><!----> <a href="/framework/flink-basis/" class="nav-link router-link-active">
  Flink 基础（In review）
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法设计与理论" class="dropdown-title"><span class="title">算法设计与理论</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法设计与理论" class="mobile-dropdown-title"><span class="title">算法设计与理论</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithm/data-structures/" class="nav-link">
  数据结构（In review）
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevOps" class="dropdown-title"><span class="title">DevOps</span> <span class="arrow down"></span></button> <button type="button" aria-label="DevOps" class="mobile-dropdown-title"><span class="title">DevOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/devops/git/" class="nav-link">
  Git（In review）
</a></li><li class="dropdown-item"><!----> <a href="/devops/dev-tools/" class="nav-link">
  工具收藏系列
</a></li></ul></div></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试题
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于" class="mobile-dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/学习方法.html" class="nav-link">
  学习方法
</a></li><li class="dropdown-item"><!----> <a href="/about/贡献说明.html" class="nav-link">
  贡献说明
</a></li></ul></div></div> <a href="https://github.com/GourdErwa/review-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Flink 基础概念</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/flink-basis/基础概念.html" class="sidebar-link">基础概念</a></li><li><a href="/framework/flink-basis/运行环境.html" class="sidebar-link">运行环境</a></li><li><a href="/framework/flink-basis/编程模型.html" class="sidebar-link">编程模型</a></li><li><a href="/framework/flink-basis/类型系统.html" class="sidebar-link">类型系统</a></li><li><a href="/framework/flink-basis/开发前准备与模拟数据集介绍.html" class="sidebar-link">开发前准备与模拟数据集介绍</a></li><li><a href="/framework/flink-basis/基础API概览.html" class="sidebar-link">基础API概览</a></li><li><a href="/framework/flink-basis/Environment概览.html" class="sidebar-link">Environment概览</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>DataSet（Batch）</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/flink-basis/DataSet概览.html" class="sidebar-link">DataSet概览</a></li><li><a href="/framework/flink-basis/DataSet分配唯一标识符.html" class="sidebar-link">DataSet分配唯一标识符</a></li><li><a href="/framework/flink-basis/DataSet参数传递.html" class="sidebar-link">DataSet参数传递</a></li><li><a href="/framework/flink-basis/DataSet广播变量.html" class="sidebar-link">DataSet广播变量</a></li><li><a href="/framework/flink-basis/DataSet分布式缓冲.html" class="sidebar-link">DataSet分布式缓冲</a></li><li><a href="/framework/flink-basis/DataSet语义注解.html" class="sidebar-link">DataSet语义注解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>DataStream（Streaming）</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/flink-basis/DataStream概览.html" class="active sidebar-link">DataStream概览</a></li><li><a href="/framework/flink-basis/DataStream时间水印机制.html" class="sidebar-link">DataStream时间水印机制</a></li><li><a href="/framework/flink-basis/DataStream-ProcessFunction.html" class="sidebar-link">DataStream-ProcessFunction</a></li><li><a href="/framework/flink-basis/DataStream窗口机制.html" class="sidebar-link">DataStream窗口机制</a></li><li><a href="/framework/flink-basis/DataStream窗口功能函数.html" class="sidebar-link">DataStream窗口功能函数</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p>专栏原创出处：<a href="https://github.com/GourdErwa/review-notes/tree/master/framework/flink-basis" target="_blank" rel="noopener noreferrer">github-源笔记文件 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ，<a href="https://github.com/GourdErwa/flink-advanced" target="_blank" rel="noopener noreferrer">github-源码 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，欢迎 Star，转载请附上原文出处链接和本声明。
本节内容对应<a href="https://ci.apache.org/projects/flink/flink-docs-release-1.9/dev/datastream_api.html" target="_blank" rel="noopener noreferrer">官方文档 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p></p><div class="table-of-contents"><ul><li><a href="#_1-简单示例程序">1 简单示例程序</a></li><li><a href="#_2-data-sources-数据源">2 Data Sources（数据源）</a><ul><li><a href="#基于文件">基于文件</a></li><li><a href="#基于套接字">基于套接字</a></li><li><a href="#基于集合">基于集合</a></li><li><a href="#自定义">自定义</a></li></ul></li><li><a href="#_3-data-sinks-输出端">3 Data Sinks（输出端）</a></li><li><a href="#_4-operators-算子">4 Operators（算子）</a><ul><li><a href="#transformation-转换操作">Transformation（转换操作）</a></li><li><a href="#physical-partitioning-物理分区">Physical partitioning（物理分区）</a></li><li><a href="#算子链和任务槽">算子链和任务槽</a></li></ul></li><li><a href="#_5-容错能力">5 容错能力</a></li><li><a href="#_6-延迟控制">6 延迟控制</a></li></ul></div><p></p> <h2 id="_1-简单示例程序"><a href="#_1-简单示例程序" class="header-anchor">#</a> 1 简单示例程序</h2> <p><a href="https://github.com/GourdErwa/flink-advanced/blob/master/src/main/scala/io/gourd/flink/scala/games/streaming/StreamingSimple.scala" target="_blank" rel="noopener noreferrer">示例源码 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">object</span> StreamingSimple <span class="token keyword">extends</span> StreamExecutionEnvironmentApp <span class="token punctuation">{</span>

  <span class="token keyword">val</span> rolePayDataStream<span class="token operator">:</span> DataStream<span class="token punctuation">[</span>RolePay<span class="token punctuation">]</span> <span class="token operator">=</span> GameData<span class="token punctuation">.</span>DataStream<span class="token punctuation">.</span>rolePay<span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>

  rolePayDataStream
    <span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>getDataUnix <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>       <span class="token comment">// 过滤</span>
    <span class="token punctuation">.</span>map<span class="token punctuation">(</span>o <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span>platform<span class="token punctuation">,</span> o<span class="token punctuation">.</span>dataUnix<span class="token punctuation">,</span> o<span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">// 转换为元组</span>
    <span class="token punctuation">.</span>keyBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                       <span class="token comment">// 按 platform 字段分组</span>
    <span class="token punctuation">.</span>timeWindow<span class="token punctuation">(</span>Time<span class="token punctuation">.</span>seconds<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">// 5s 窗口统计</span>
    <span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>                         <span class="token comment">// 聚合 money 字段</span>
    <span class="token punctuation">.</span>print<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
  sEnv<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>getClass<span class="token punctuation">.</span>getName<span class="token punctuation">)</span> <span class="token comment">// 执行</span>

  <span class="token comment">/* 持续性输出部分示例：
  3&gt; (IOS_YY,1571497479,4170.0)
  4&gt; (ADR,1571576109,2640.0)
  1&gt; (IOS,1571575689,5230.0)
  1&gt; (H5,1571576559,2084.0)
    ...
    ...
   */</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_2-data-sources-数据源"><a href="#_2-data-sources-数据源" class="header-anchor">#</a> 2 Data Sources（数据源）</h2> <h3 id="基于文件"><a href="#基于文件" class="header-anchor">#</a> 基于文件</h3> <ul><li><code>createInput(inputFormat)</code>-自定义文件基础类</li> <li><code>readTextFile(path)// TextInputFormat</code>-逐行读取文件，并将它们作为字符串返回。</li> <li><code>readFile(fileInputFormat, path)</code>-根据指定的文件输入格式读取（一次）文件。</li> <li><code>readFile(fileInputFormat, path, watchType, interval, pathFilter)-</code>-监控文件并读取数据</li> <li><code>readFileOfPrimitives(path, delimiter)</code>// PrimitiveInputFormat-解析以换行符（或其他 char 序列）定界的原始数据类型的文件，例如 String 或 Integer 使用给定的定界符。</li> <li><code>readSequenceFile(Key, Value, path)</code>// SequenceFileInputFormat-创建 JobConf 并从指定的路径中读取类型为 SequenceFileInputFormat，Key 类和 Value 类的文件，并将它们作为 Tuple2 &lt;Key，Value&gt; 返回。</li></ul> <h3 id="基于套接字"><a href="#基于套接字" class="header-anchor">#</a> 基于套接字</h3> <ul><li><code>socketTextStream</code>-从 socket 读取。数据可以由分隔符分割。</li></ul> <h3 id="基于集合"><a href="#基于集合" class="header-anchor">#</a> 基于集合</h3> <ul><li><code>fromCollection(Seq)</code>-从 Java Java.util.Collection 创建数据流。集合中的所有数据必须具有相同的类型。不能并行执行（并行度=1）</li> <li><code>fromCollection(Iterator)</code>-从迭代器创建数据流。该类指定迭代器返回的数据的数据类型。不能并行执行（并行度=1）</li> <li><code>fromElements(elements: _*)</code>-从给定的对象序列创建数据流。所有对象必须具有相同的类型。不能并行执行（并行度=1）</li> <li><code>fromParallelCollection(SplittableIterator)</code>-从迭代器并行创建数据流。该类指定迭代器返回的数据的数据类型。</li> <li><code>generateSequence(from, to)</code> -并行生成给定间隔中的数字序列。</li></ul> <h3 id="自定义"><a href="#自定义" class="header-anchor">#</a> 自定义</h3> <ul><li><code>addSource</code>-自定义<code>SourceFunction</code>数据源读取。</li></ul> <h2 id="_3-data-sinks-输出端"><a href="#_3-data-sinks-输出端" class="header-anchor">#</a> 3 Data Sinks（输出端）</h2> <ul><li><code>writeAsText()/ TextOutputFormat</code>-将数据按行写为字符串。通过调用每个数据的 toString 方法获得字符串。</li> <li><code>writeAsCsv(...)/ CsvOutputFormat</code>-将元组写为逗号分隔的值文件。行和字段定界符是可配置的。每个字段的值来自对象的 toString 方法。</li> <li><code>print()/ printToErr()</code> - 在标准输出/标准错误流上打印每个数据的 toString（）值。可以提供前缀字符串区分不同的打印调用。如果并行度大于 1，则输出之前还将带有产生输出的任务的标识符。</li> <li><code>writeUsingOutputFormat()/ FileOutputFormat</code>-自定义文件输出的方法和基础类。支持自定义对象到字节的转换。</li> <li><code>writeToSocket</code> -根据以下内容将数据写入套接字 SerializationSchema</li> <li><code>addSink</code>-调用自定义接收器功能。Flink 捆绑有连接到其他系统（例如 Apache Kafka）的连接器，这些连接器实现为接收器功能。</li></ul> <blockquote><p>请注意，上的 write*() 方法 DataStream 主要用于调试目的。它们不参与 Flink 的检查点，这意味着这些功能通常具有至少一次的语义。刷新到目标系统的数据取决于 OutputFormat 的实现。这意味着并非所有发送到 OutputFormat 的数据都立即显示在目标系统中。同样，在失败的情况下，这些记录可能会丢失。</p></blockquote> <p><strong>说明</strong>
为了将流可靠，准确地一次传输到文件系统中，请使用<code>flink-connector-filesystem</code>。</p> <p>Flink 还提供接收器以收集 DataStream 结果以进行测试和调试。可以如下使用：</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span></span>DataStreamUtils
<span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>collection<span class="token punctuation">.</span></span>JavaConverters<span class="token punctuation">.</span>asScalaIteratorConverter

<span class="token keyword">val</span> myResult<span class="token operator">:</span> DataStream<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">val</span> myOutput<span class="token operator">:</span> Iterator<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> DataStreamUtils<span class="token punctuation">.</span>collect<span class="token punctuation">(</span>myResult<span class="token punctuation">.</span>javaStream<span class="token punctuation">)</span><span class="token punctuation">.</span>asScala
</code></pre></div><h2 id="_4-operators-算子"><a href="#_4-operators-算子" class="header-anchor">#</a> 4 Operators（算子）</h2> <h3 id="transformation-转换操作"><a href="#transformation-转换操作" class="header-anchor">#</a> Transformation（转换操作）</h3> <h4 id="map"><a href="#map" class="header-anchor">#</a> Map</h4> <p><strong>DataStream -&gt; DataStream</strong><br>
一个元素转换为一个新的元素</p> <div class="language-scala extra-class"><pre class="language-scala"><code>dataStream<span class="token punctuation">.</span>map <span class="token punctuation">{</span> x <span class="token keyword">=&gt;</span> x <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">}</span>
</code></pre></div><h4 id="flatmap"><a href="#flatmap" class="header-anchor">#</a> FlatMap</h4> <p><strong>DataStream -&gt; DataStream</strong><br>
一个元素转换为零个，一个或多个新的元素</p> <div class="language-scala extra-class"><pre class="language-scala"><code>dataStream<span class="token punctuation">.</span>flatMap <span class="token punctuation">{</span> str <span class="token keyword">=&gt;</span> str<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre></div><h4 id="filter"><a href="#filter" class="header-anchor">#</a> Filter</h4> <p><strong>DataStream -&gt; DataStream</strong></p> <p>为每个元素执行 boolean 函数判断，仅返回为 true 的元素</p> <div class="language-scala extra-class"><pre class="language-scala"><code>dataStream<span class="token punctuation">.</span>filter <span class="token punctuation">{</span> _ <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">}</span>
</code></pre></div><h4 id="keyby"><a href="#keyby" class="header-anchor">#</a> KeyBy</h4> <p><strong>DataStream -&gt; KeyedStream</strong></p> <p>在逻辑上将流划分为不相交的分区，每个分区都包含同一键的元素。在内部是通过哈希分区实现的</p> <div class="language-scala extra-class"><pre class="language-scala"><code>dataStream<span class="token punctuation">.</span>keyBy<span class="token punctuation">(</span><span class="token string">&quot;someKey&quot;</span><span class="token punctuation">)</span> <span class="token comment">// Key by field &quot;someKey&quot;</span>
dataStream<span class="token punctuation">.</span>keyBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// Key by the first element of a Tuple</span>
</code></pre></div><h4 id="reduce"><a href="#reduce" class="header-anchor">#</a> Reduce</h4> <p><strong>KeyedStream -&gt; DataStream</strong></p> <p>对<code>KeyedStream</code>进行<code>reduce</code>函数操作</p> <div class="language-scala extra-class"><pre class="language-scala"><code>keyedStream<span class="token punctuation">.</span>reduce <span class="token punctuation">{</span> _ <span class="token operator">+</span> _ <span class="token punctuation">}</span>
</code></pre></div><h4 id="fold"><a href="#fold" class="header-anchor">#</a> Fold</h4> <p><strong>KeyedStream -&gt; DataStream</strong></p> <p>对<code>KeyedStream</code>进行<code>fold</code>函数操作</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> result<span class="token operator">:</span> DataStream<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span>
    keyedStream<span class="token punctuation">.</span>fold<span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token punctuation">{</span> str <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">+</span> i <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="aggregations"><a href="#aggregations" class="header-anchor">#</a> Aggregations</h4> <p><strong>KeyedStream -&gt; DataStream</strong></p> <p>对<code>KeyedStream</code>进行<code>Aggregations</code>函数操作，支持求最大、最小、和运算</p> <div class="language-scala extra-class"><pre class="language-scala"><code>keyedStream<span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
keyedStream<span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span>
keyedStream<span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
keyedStream<span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span>
keyedStream<span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
keyedStream<span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span>
keyedStream<span class="token punctuation">.</span>minBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
keyedStream<span class="token punctuation">.</span>minBy<span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span>
keyedStream<span class="token punctuation">.</span>maxBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
keyedStream<span class="token punctuation">.</span>maxBy<span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="window"><a href="#window" class="header-anchor">#</a> Window</h4> <p><strong>KeyedStream -&gt; WindowedStream</strong></p> <p>在已经分区的<code>KeyedStream</code>上定义 Windows。 Windows 根据某些特征将每个键中的数据分组（例如，最近 5 秒钟内到达的数据）</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token comment">// Last 5 seconds of data</span>
dataStream<span class="token punctuation">.</span>keyBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>window<span class="token punctuation">(</span>TumblingEventTimeWindows<span class="token punctuation">.</span>of<span class="token punctuation">(</span>Time<span class="token punctuation">.</span>seconds<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
</code></pre></div><h4 id="windowall"><a href="#windowall" class="header-anchor">#</a> WindowAll</h4> <p><strong>DataStream -&gt; AllWindowedStream</strong></p> <p>Windows 可以在常规 DataStreams 上定义。 Windows 会根据某些特征（例如，最近 5 秒钟内到达的数据）对所有流事件进行分组</p> <blockquote><p>警告：在许多情况下，这是非并行转换。所有记录将被收集在 windowAll 运算符的一项任务中。</p></blockquote> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token comment">// Last 5 seconds of data</span>
dataStream<span class="token punctuation">.</span>windowAll<span class="token punctuation">(</span>TumblingEventTimeWindows<span class="token punctuation">.</span>of<span class="token punctuation">(</span>Time<span class="token punctuation">.</span>seconds<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
</code></pre></div><h4 id="window-apply"><a href="#window-apply" class="header-anchor">#</a> Window Apply</h4> <p><strong>WindowedStream -&gt; DataStream</strong></p> <p><strong>AllWindowedStream -&gt; DataStream</strong></p> <p>将一般功能应用于整个窗口。以下是一个手动汇总窗口元素的函数。</p> <blockquote><p>注意：如果使用 windowAll 转换，则需要使用 AllWindowFunction。</p></blockquote> <div class="language-scala extra-class"><pre class="language-scala"><code>windowedStream<span class="token punctuation">.</span>apply <span class="token punctuation">{</span> WindowFunction <span class="token punctuation">}</span>
<span class="token comment">// applying an AllWindowFunction on non-keyed window stream</span>
allWindowedStream<span class="token punctuation">.</span>apply <span class="token punctuation">{</span> AllWindowFunction <span class="token punctuation">}</span>
</code></pre></div><h4 id="window-reduce"><a href="#window-reduce" class="header-anchor">#</a> Window Reduce</h4> <p><strong>WindowedStream -&gt; DataStream</strong>	
将 reduce 函数应用于窗口，并返回减小的值。</p> <div class="language-scala extra-class"><pre class="language-scala"><code>windowedStream<span class="token punctuation">.</span>reduce <span class="token punctuation">{</span> _ <span class="token operator">+</span> _ <span class="token punctuation">}</span>
</code></pre></div><h4 id="window-fold"><a href="#window-fold" class="header-anchor">#</a> Window Fold</h4> <p><strong>WindowedStream -&gt; DataStream</strong></p> <p>在<code>WindowedStream</code>上应用<code>fold</code>函数</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> result<span class="token operator">:</span> DataStream<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span>
    windowedStream<span class="token punctuation">.</span>fold<span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>str<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token punctuation">{</span> str <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">+</span> i <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="aggregations-on-windows"><a href="#aggregations-on-windows" class="header-anchor">#</a> Aggregations on windows</h4> <p><strong>WindowedStream -&gt; DataStream</strong></p> <p>对<code>WindowedStream</code>进行<code>Aggregations</code>函数操作，支持求最大、最小、和运算</p> <div class="language-scala extra-class"><pre class="language-scala"><code>windowedStream<span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
windowedStream<span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span>
windowedStream<span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
windowedStream<span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span>
windowedStream<span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
windowedStream<span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span>
windowedStream<span class="token punctuation">.</span>minBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
windowedStream<span class="token punctuation">.</span>minBy<span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span>
windowedStream<span class="token punctuation">.</span>maxBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
windowedStream<span class="token punctuation">.</span>maxBy<span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="union"><a href="#union" class="header-anchor">#</a> Union</h4> <p><strong><code>DataStream*</code> -&gt; DataStream</strong></p> <p>两个或多个<code>DataStream</code>的并集，创建一个包含所有流中所有元素的新流。</p> <blockquote><p>注意：如果将<code>DataStream</code>与其自身合并，则在结果流中每个元素将获得两次。</p></blockquote> <div class="language-scala extra-class"><pre class="language-scala"><code>dataStream<span class="token punctuation">.</span>union<span class="token punctuation">(</span>otherStream1<span class="token punctuation">,</span> otherStream2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="window-join"><a href="#window-join" class="header-anchor">#</a> Window Join</h4> <p><strong>DataStream,DataStream -&gt; DataStream</strong></p> <p>在给定键和一个公共窗口上连接两个数据流。</p> <div class="language-scala extra-class"><pre class="language-scala"><code>dataStream<span class="token punctuation">.</span>join<span class="token punctuation">(</span>otherStream<span class="token punctuation">)</span>
    <span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token generics"><span class="token punctuation">&lt;</span>key selector<span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>equalTo<span class="token punctuation">(</span><span class="token generics"><span class="token punctuation">&lt;</span>key selector<span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>window<span class="token punctuation">(</span>TumblingEventTimeWindows<span class="token punctuation">.</span>of<span class="token punctuation">(</span>Time<span class="token punctuation">.</span>seconds<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>apply <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><h4 id="window-cogroup"><a href="#window-cogroup" class="header-anchor">#</a> Window CoGroup</h4> <p><strong>DataStream,DataStream -&gt; DataStream</strong></p> <p>在给定键和公共窗口上将两个数据流组合在一起。</p> <div class="language-scala extra-class"><pre class="language-scala"><code>dataStream<span class="token punctuation">.</span>coGroup<span class="token punctuation">(</span>otherStream<span class="token punctuation">)</span>
    <span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>equalTo<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>window<span class="token punctuation">(</span>TumblingEventTimeWindows<span class="token punctuation">.</span>of<span class="token punctuation">(</span>Time<span class="token punctuation">.</span>seconds<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>apply <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="connect"><a href="#connect" class="header-anchor">#</a> Connect</h4> <p><strong>DataStream,DataStream -&gt; ConnectedStreams</strong></p> <p>“连接”两个保留其类型的数据流，从而允许两个流之间共享状态。</p> <div class="language-scala extra-class"><pre class="language-scala"><code>someStream <span class="token operator">:</span> DataStream<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
otherStream <span class="token operator">:</span> DataStream<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">val</span> connectedStreams <span class="token operator">=</span> someStream<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>otherStream<span class="token punctuation">)</span>
</code></pre></div><h4 id="comap-coflatmap"><a href="#comap-coflatmap" class="header-anchor">#</a> CoMap, CoFlatMap</h4> <p><strong>ConnectedStreams -&gt; DataStream</strong></p> <p>与<code>DataStream</code>的 map 和 flatMap 相似，使用类型匹配匹配流进行计算</p> <div class="language-scala extra-class"><pre class="language-scala"><code>connectedStreams<span class="token punctuation">.</span>map<span class="token punctuation">(</span>
    <span class="token punctuation">(</span>_ <span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span>_ <span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token boolean">false</span>
<span class="token punctuation">)</span>
connectedStreams<span class="token punctuation">.</span>flatMap<span class="token punctuation">(</span>
    <span class="token punctuation">(</span>_ <span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span>_ <span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token boolean">false</span>
<span class="token punctuation">)</span>
</code></pre></div><h4 id="split"><a href="#split" class="header-anchor">#</a> Split</h4> <p><strong>DataStream -&gt; SplitStream</strong></p> <p>根据某些<em>标准</em>将流分成两个或多个流。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> split <span class="token operator">=</span> someDataStream<span class="token punctuation">.</span>split<span class="token punctuation">(</span>
  <span class="token punctuation">(</span>num<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span>
    <span class="token punctuation">(</span>num <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">match</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token number">0</span> <span class="token keyword">=&gt;</span> List<span class="token punctuation">(</span><span class="token string">&quot;even&quot;</span><span class="token punctuation">)</span>
      <span class="token keyword">case</span> <span class="token number">1</span> <span class="token keyword">=&gt;</span> List<span class="token punctuation">(</span><span class="token string">&quot;odd&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><h4 id="select"><a href="#select" class="header-anchor">#</a> Select</h4> <p><strong>SplitStream -&gt; DataStream</strong></p> <p>从拆分流中选择一个或多个流。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> even <span class="token operator">=</span> split select <span class="token string">&quot;even&quot;</span>
<span class="token keyword">val</span> odd <span class="token operator">=</span> split select <span class="token string">&quot;odd&quot;</span>
<span class="token keyword">val</span> all <span class="token operator">=</span> split<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;even&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;odd&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="iterate"><a href="#iterate" class="header-anchor">#</a> Iterate</h4> <p><strong>DataStream -&gt; IterativeStream -&gt; DataStream</strong></p> <p>DataStream 迭代计算</p> <div class="language-scala extra-class"><pre class="language-scala"><code>initialStream<span class="token punctuation">.</span>iterate <span class="token punctuation">{</span>
  iteration <span class="token keyword">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> iterationBody <span class="token operator">=</span> iteration<span class="token punctuation">.</span>map <span class="token punctuation">{</span><span class="token comment">/*do something*/</span><span class="token punctuation">}</span>
    <span class="token punctuation">(</span>iterationBody<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_ <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> iterationBody<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_ <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="extract-timestamps"><a href="#extract-timestamps" class="header-anchor">#</a> Extract Timestamps</h4> <p><strong>DataStream -&gt; DataStream</strong></p> <p>从记录中提取时间戳，以便与使用事件时间语义的窗口一起使用。请参<code>5.1-Flink DataStream 时间机制 (Time&amp;Watermark)</code>。</p> <div class="language-scala extra-class"><pre class="language-scala"><code>stream<span class="token punctuation">.</span>assignTimestamps <span class="token punctuation">{</span> timestampExtractor <span class="token punctuation">}</span>
</code></pre></div><h4 id="extensions-api-扩展-api"><a href="#extensions-api-扩展-api" class="header-anchor">#</a> extensions API（扩展 API）</h4> <p>利用类型匹配计算，支持 API 参考 <a href="https://ci.apache.org/projects/flink/flink-docs-release-1.9/dev/scala_api_extensions.html#datastream-api" target="_blank" rel="noopener noreferrer">scala_api_extensions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>api<span class="token punctuation">.</span>scala<span class="token punctuation">.</span>extensions<span class="token punctuation">.</span></span>_

data<span class="token punctuation">.</span>mapWith <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token punctuation">(</span>_<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> value<span class="token punctuation">.</span>toString
<span class="token punctuation">}</span>
</code></pre></div><h3 id="physical-partitioning-物理分区"><a href="#physical-partitioning-物理分区" class="header-anchor">#</a> Physical partitioning（物理分区）</h3> <h4 id="custom-partitioning-自定义分区"><a href="#custom-partitioning-自定义分区" class="header-anchor">#</a> Custom partitioning（自定义分区）</h4> <div class="language-scala extra-class"><pre class="language-scala"><code>dataStream<span class="token punctuation">.</span>partitionCustom<span class="token punctuation">(</span>partitioner<span class="token punctuation">,</span> <span class="token string">&quot;someKey&quot;</span><span class="token punctuation">)</span>
dataStream<span class="token punctuation">.</span>partitionCustom<span class="token punctuation">(</span>partitioner<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="random-partitioning-随机分区"><a href="#random-partitioning-随机分区" class="header-anchor">#</a> Random partitioning（随机分区）</h4> <p><code>dataStream.shuffle()</code></p> <h4 id="rebalancing-重新负载分区"><a href="#rebalancing-重新负载分区" class="header-anchor">#</a> Rebalancing（重新负载分区）</h4> <p>内容使用<code>round robin</code>方法将数据均匀打散。存在数据偏斜的情况下对性能优化有用。
<code>dataStream.rebalance()</code></p> <h4 id="rescaling-重新缩放"><a href="#rescaling-重新缩放" class="header-anchor">#</a> Rescaling（重新缩放）</h4> <p>通过执行 oepration 算子来实现的。由于这种方式仅发生在一个单一的节点，因此没有跨网络的数据传输。</p> <p>如果上游操作有 2 个并发，而下游操作有 4 个并发，那么上游的一个并发结果分配给下游的两个并发操作，另外的一个并发结果分配给了下游的另外两个并发操作。<br>
另一方面，下游有两个并发操作而上游又 4 个并发操作，那么上游的其中两个操作的结果分配给下游的一个并发操作而另外两个并发操作的结果则分配给另外一个并发操作。</p> <blockquote><p>Rebalancing 会产生全量重分区，而 Rescaling 不会。</p></blockquote> <p><code>dataStream.rescale()</code></p> <h4 id="broadcasting-广播"><a href="#broadcasting-广播" class="header-anchor">#</a> Broadcasting（广播）</h4> <p>广播用于将 dataStream 所有数据发到每一个 partition。
<code>inputStream.broadcast()</code></p> <h3 id="算子链和任务槽"><a href="#算子链和任务槽" class="header-anchor">#</a> 算子链和任务槽</h3> <ul><li>Flink 出于分布式执行的目的，将 operator 的 subtask 链接在一起形成 task（类似 spark 中的管道）。</li> <li>每个 task 在一个线程中执行。</li> <li>将 operators 链接成 task 是非常有效的优化：它可以减少线程与线程间的切换和数据缓冲的开销，并在降低延迟的同时提高整体吞吐量。</li></ul> <blockquote><p>参考***《运行环境》***内容</p></blockquote> <h4 id="开始新算子链"><a href="#开始新算子链" class="header-anchor">#</a> 开始新算子链</h4> <p><code>someStream.filter(...).map(...).startNewChain().map(...)</code></p> <h4 id="禁用算子链"><a href="#禁用算子链" class="header-anchor">#</a> 禁用算子链</h4> <p><code>someStream.map(...).disableChaining()</code></p> <h4 id="显示指定任务槽"><a href="#显示指定任务槽" class="header-anchor">#</a> 显示指定任务槽</h4> <p><code>someStream.filter(...).slotSharingGroup(&quot;name&quot;)</code></p> <h2 id="_5-容错能力"><a href="#_5-容错能力" class="header-anchor">#</a> 5 容错能力</h2> <blockquote><p>参考<a href="https://github.com/GourdErwa/flink-advanced/blob/master/flink-notes/7.0-Flink%E7%8A%B6%E6%80%81%E4%B8%8E%E5%AE%B9%E9%94%99.md" target="_blank" rel="noopener noreferrer">7.0-Flink 状态与容错 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="_6-延迟控制"><a href="#_6-延迟控制" class="header-anchor">#</a> 6 延迟控制</h2> <p>默认情况下，数据不会在网络上一对一传输（这会导致不必要的网络通信），但是会进行缓冲。</p> <p>缓冲区的大小（实际上是在计算机之间传输的）可以在 Flink 配置文件中设置。<br>
尽管此方法可以优化吞吐量，但是当传入流不够快时，它可能会导致延迟问题。<br>
为了控制吞吐量和延迟，可以<code>env.setBufferTimeout(timeoutMillis)</code>在执行环境（或各个运算符）上使用来设置缓冲区填充的最大等待时间。<br>
在此时间之后，即使缓冲区未满，也会自动发送缓冲区。</p> <blockquote><p>此超时的默认值为 100 毫秒。</p></blockquote> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> env<span class="token operator">:</span> LocalStreamEnvironment <span class="token operator">=</span> StreamExecutionEnvironment<span class="token punctuation">.</span>createLocalEnvironment
env<span class="token punctuation">.</span>setBufferTimeout<span class="token punctuation">(</span>timeoutMillis<span class="token punctuation">)</span>

env<span class="token punctuation">.</span>generateSequence<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>map<span class="token punctuation">(</span>myMap<span class="token punctuation">)</span><span class="token punctuation">.</span>setBufferTimeout<span class="token punctuation">(</span>timeoutMillis<span class="token punctuation">)</span>
</code></pre></div><ul><li>为了<strong>最大化吞吐量</strong>，请设置 set setBufferTimeout(-1) 来消除超时，并且仅在缓冲区已满时才刷新它们。</li> <li>为了<strong>最小化延迟</strong>，请将超时设置为接近 0 的值（例如 5 或 10 ms）。应避免将缓冲区超时设置为 0，因为它可能导致严重的性能下降。</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后修改时间:</span> <span class="time">2/17/2020, 4:43:04 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/framework/flink-basis/DataSet语义注解.html" class="prev">
        DataSet语义注解
      </a></span> <span class="next"><a href="/framework/flink-basis/DataStream时间水印机制.html">
        DataStream时间水印机制
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.7b04417e.js" defer></script><script src="/assets/js/2.62143406.js" defer></script><script src="/assets/js/72.c7d09a18.js" defer></script>
  </body>
</html>
